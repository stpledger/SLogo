if (self.CavalryLogger) { CavalryLogger.start_js(["RPqEP"]); }

__d("NotificationListItemBase.react",["csx","cx","invariant","AsyncDialog","AsyncResponse","BizSiteIdentifier.brands","Bootloader","LogicalGridCell.react","LogicalGridRow.react","NotificationConstants","NotificationListConfig","NotificationListItemChevron.react","NotificationListItemContents.react","NotificationListItemOptionConfirmation.react","NotificationListItemReadToggle.react","NotificationTracking","NotificationUpdates","NotificationUserActions","NotifTestIDs","Parent","React","ReactDOM","Style","URI","compactArray","createObjectFrom","idx"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l,m=c("BizSiteIdentifier.brands").isBizSite(),n=-1;function o(q){if(q.length===0)return;var r=q[0],s=r.description,t=r.is_silent,u=r.is_transient,v=r.message,w=new(c("AsyncResponse"))();w.errorSummary=s;w.errorDescription=v;w.silentError=t;w.transientError=u;c("AsyncResponse").defaultErrorHandler(w)}k=babelHelpers.inherits(p,c("React").Component);l=k&&k.prototype;function p(){__p&&__p();var q,r;"use strict";for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=l.constructor).call.apply(q,[this].concat(t)),this.prefetched=false,this.isLiveVideo=null,this.$NotificationListItemBase1=false,this.state={actionsTaken:[],sendingFeedback:false},this.$NotificationListItemBase4=function(){c("NotificationUserActions").setNextIsFromReadButton(true);if(this.props.isRead){if(this.props.canMarkUnread)if(this.props.onMarkItemUnread)this.props.onMarkItemUnread()}else if(this.props.onMarkItemRead)this.props.onMarkItemRead()}.bind(this),this.$NotificationListItemBase7=function(v){__p&&__p();var w,x,y=this,z=(w=v)!=null?(w=w.client_info)!=null?w.action_type:w:w;if(z==null)return;if(z==="REPORT_BUG"){var A=new(c("URI"))("/ajax/bugs/employee_report").setQueryData({client_notifs:JSON.stringify(this.props.getDebugData()),notif_alert_id:this.$NotificationListItemBase3()});c("AsyncDialog").bootstrap(A.toString(),null,"dialog")}else if(z==="OPEN_IN_INSPECTOR"){var B,C=(B=v)!=null?(B=B.option_display)!=null?(B=B.subtext)!=null?B.text:B:B:B;C!=null||j(0);window.open(C,"_blank")}else{var x=function(){__p&&__p();var D=v.server_action;if(D==null)return{v:void 0};y.setState({sendingFeedback:true});c("NotificationUserActions").sendNotifOption(D).done(function(E){if(this.$NotificationListItemBase1)return;this.setState(function(F){var G,H,I,J=(G=E)!=null?(G=G.notif_option_action)!=null?(G=G.notification)!=null?(G=G.notif_option_sets)!=null?(G=G.edges)!=null?(G=G[0])!=null?(G=G.node)!=null?(G=G.notif_options)!=null?G.edges:G:G:G:G:G:G:G:G,K=babelHelpers["extends"]({},F,{actionsTaken:F.actionsTaken.concat([{actionToken:D,type:z,nextNotificationOptions:J&&c("compactArray")(J.map(function(L){var M=L.node;return M})),undoText:(H=v)!=null?(H=H.option_display)!=null?H.undo_text:H:H,undoToken:(I=v)!=null?(I=I.client_info)!=null?I.undo_server_action:I:I}]),sendingFeedback:false});c("NotificationUpdates").handleUpdate(c("NotificationConstants").PayloadSourceType.USER_ACTION,{hiddenState:c("createObjectFrom")([this.$NotificationListItemBase3()],this.$NotificationListItemBase10(K))});return K}.bind(this))}.bind(y),y.$NotificationListItemBase12)}();if(typeof x==="object")return x.v}}.bind(this),this.$NotificationListItemBase13=function(){__p&&__p();var v=this.$NotificationListItemBase3();this.setState({sendingFeedback:true});var w=this.state.actionsTaken[this.state.actionsTaken.length-1];if(w&&w.undoToken!=null)c("NotificationUserActions").sendNotifOption(w.undoToken).done(function(x){if(this.$NotificationListItemBase1)return;this.setState(function(y){var z=babelHelpers["extends"]({},y,{actionsTaken:y.actionsTaken.slice(0,this.state.actionsTaken.length-1),sendingFeedback:false});c("NotificationUpdates").handleUpdate(c("NotificationConstants").PayloadSourceType.USER_ACTION,{hiddenState:c("createObjectFrom")([v],this.$NotificationListItemBase10(z))});return z}.bind(this))}.bind(this),this.$NotificationListItemBase12)}.bind(this),this.$NotificationListItemBase12=function(v){var w=v.errors;if(this.$NotificationListItemBase1)return;o(w);this.setState({sendingFeedback:false})}.bind(this),r}p.prototype.$NotificationListItemBase3=function(){"use strict";return this.props.notification.alert_id};p.prototype.$NotificationListItemBase5=function(){"use strict";var q=this.props,r=q.canMarkUnread,s=q.isRead;return c("React").createElement(c("NotificationListItemReadToggle.react"),{canMarkUnread:r,isRead:!!s,onToggleClick:this.$NotificationListItemBase4})};p.prototype.$NotificationListItemBase6=function(){var q;"use strict";var r=this.props,s=r.onChevronHide,t=r.onChevronShow,u=r.notification,v=u.alert_id,w=u.notif_option_sets,x=u.notif_type,y=u.renderer_data,z=false;if(y&&(y.__typename==="FallbackNotificationRendererData"||y.__typename==="LiveVideoNotificationRendererData")&&y.should_log_menu_exposure!=null)z=y.should_log_menu_exposure;var A=(q=w)!=null?(q=q.edges)!=null?(q=q[0])!=null?(q=q.node)!=null?(q=q.notif_options)!=null?q.edges:q:q:q:q:q;return c("React").createElement(c("NotificationListItemChevron.react"),{alert_id:v,className:"_55m9",notif_type:x,notificationOptions:A&&c("compactArray")(A.map(function(B){var C=B.node;return C})),onHide:s,onMenuOptionClick:this.$NotificationListItemBase7,onShow:t,logMenuExposure:z})};p.prototype.shouldComponentUpdate=function(q,r){"use strict";var s=this.props.visible!==q.visible||this.props.isRead!==q.isRead||this.props.isSelected!==q.isSelected||this.props.notification.timestamp!==q.notification.timestamp||this.state.actionsTaken.length!==r.actionsTaken.length||this.state.sendingFeedback!==r.sendingFeedback;return s||!!this.props.hasCustomForeground&&this.props.paused!==q.paused};p.prototype.componentWillUpdate=function(q){"use strict";if(!this.$NotificationListItemBase2||!q.isSelected||this.props.isSelected)return;var r=c("ReactDOM").findDOMNode(this.$NotificationListItemBase2);r&&r.scrollIntoViewIfNeeded&&r.scrollIntoViewIfNeeded(false)};p.prototype.componentWillReceiveProps=function(q){"use strict";if(this.props.paused&&!q.paused&&!this.props.visible&&this.state.actionsTaken.length>0)this.setState({actionsTaken:[]})};p.prototype.componentDidMount=function(){"use strict";if(this.$NotificationListItemBase8())c("Bootloader").loadModules(["VideoPlayerMetaData"],function(q){q.genVideoData(this.$NotificationListItemBase9()).done()}.bind(this),"NotificationListItemBase.react")};p.prototype.componentDidUpdate=function(){"use strict";if(this.props.enableHubView&&this.props.isSelected&&this.$NotificationListItemBase2){var q=c("ReactDOM").findDOMNode(this.$NotificationListItemBase2);if(q&&typeof q.focus=="function")q.focus()}};p.prototype.$NotificationListItemBase10=function(){var q=arguments.length<=0||arguments[0]===undefined?this.state:arguments[0];"use strict";return q.actionsTaken.some(function(r){return r.type==="HIDE"})};p.prototype.$NotificationListItemBase11=function(){"use strict";var q=c("ReactDOM").findDOMNode(this);if(!q)return false;var r=c("Parent").bySelector(q,".__tw"),s=r?r.parentNode:null;return s?c("Style").get(s,"display")!=="none":false};p.prototype.$NotificationListItemBase14=function(q){"use strict";if(this.state.actionsTaken.length>=2)return null;var r={};this.state.actionsTaken.forEach(function(s){r[s.actionToken]=true});return q.filter(function(s){var t=s.server_action;return t==null||r[t]!==true})};p.prototype.$NotificationListItemBase9=function(){"use strict";var q=c("NotificationTracking").getEncodedTrackingData(this.props.notification,this.props.row);return q.content_id||null};p.prototype.$NotificationListItemBase8=function(){"use strict";if(this.isLiveVideo===null){var q=c("NotificationTracking").getTrackingString(this.props.notification,this.props.row);this.isLiveVideo=q.indexOf("live_video")!==-1}return!!this.isLiveVideo};p.prototype.render=function(){"use strict";__p&&__p();if(!this.props.visible&&!this.$NotificationListItemBase10())return c("React").createElement("li",{className:"_4_62"});var q="_33c"+(c("NotificationListConfig").isWork?" _1rqj":"")+(!this.props.isRead?" jewelItemNew":"")+(this.state.sendingFeedback?" _4m8s":"")+(this.props.hasCustomForeground?" _3u5n":"")+(this.props.isSelected?" _u-o":""),r=c("NotificationTracking").getTrackingString(this.props.notification,this.props.row),s=this.props.rowIndex;if(this.state.actionsTaken.length>0){var t=this.state.actionsTaken[this.state.actionsTaken.length-1];return c("React").createElement("li",{className:q,"data-gt":r,"data-testid":c("NotifTestIDs").NOTIF_LIST_ITEM},c("React").createElement(c("LogicalGridRow.react"),{className:"_dre",rowIndex:s,component:c("React").createElement("div",null)},c("React").createElement(c("LogicalGridCell.react"),{columnIndex:0,component:c("React").createElement("div",null)},c("React").createElement(c("NotificationListItemOptionConfirmation.react"),{notificationOptions:t.nextNotificationOptions?this.$NotificationListItemBase14(t.nextNotificationOptions):null,onUndoClick:this.$NotificationListItemBase13,onMenuOptionClick:this.$NotificationListItemBase7,undoText:t.undoText,undoToken:t.undoToken}))))}var u=c("React").createElement(c("NotificationListItemContents.react"),this.props),v=this.props.renderLink(u);return c("React").createElement("li",{className:q,"data-gt":r,"data-alert-id":this.$NotificationListItemBase3(),"data-testid":c("NotifTestIDs").NOTIF_LIST_ITEM},c("React").createElement(c("LogicalGridRow.react"),{className:"_dre anchorContainer",rowIndex:s,component:c("React").createElement("div",null)},c("React").createElement(c("LogicalGridCell.react"),{columnIndex:0,component:c("React").createElement("div",null)},v),c("React").createElement("ul",{className:"_55mc"},c("React").createElement(c("LogicalGridCell.react"),{columnIndex:1,component:c("React").createElement("li",{className:"_h_c"})},this.$NotificationListItemBase5()),c("React").createElement(c("LogicalGridCell.react"),{columnIndex:2,component:c("React").createElement("li",{className:"_h_d"}),disableFocusRecovery:true},this.$NotificationListItemBase6()))))};f.exports=p}),null);