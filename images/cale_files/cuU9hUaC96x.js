if (self.CavalryLogger) { CavalryLogger.start_js(["ARSKu"]); }

__d("MessengerReactions.react",["cx","fbt","Bootloader","CurrentUser","MercuryAttachmentType","MercuryConfig","MercuryIDs","MercuryParticipants","MessengerEnvironment","MessengerReactionsPrompt.react","MessengerReactionsUtil","MessengerTextWithEmoticons.react","MessengerWebViewReactionsTypedLogger","React","ShimButton.react","StoryAttachmentStyle","TooltipData","gkx","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="ALL",n=c("CurrentUser").getID(),o=3,p=9;j=babelHelpers.inherits(q,c("React").Component);k=j&&j.prototype;function q(){__p&&__p();var r,s;for(var t=arguments.length,u=Array(t),v=0;v<t;v++)u[v]=arguments[v];return s=(r=k.constructor).call.apply(r,[this].concat(u)),this.$MessengerReactions2=function(){var w=c("MessengerEnvironment").messengerui,x=this.props,y=x.isFromViewer,z=x.message,A=x.participants,B=z.reactions;new(c("MessengerWebViewReactionsTypedLogger"))().setEvent("open_details").setMid(z.message_id).setSenderID(z.author).setEmojiGroup(m).setEmojiGroupCount(Object.values(B).length).log();if(w)c("Bootloader").loadModules(["MessengerDialogs.bs","MessengerReactionsDialogReact.bs"],function(C,D){var E=D.jsComponent;C.showDialog(function(){return c("React").createElement(E,{isFromViewer:y,participants:A,message:z})})},"MessengerReactions.react");else c("Bootloader").loadModules(["ChatReactionsDialog"],function(C){C.show(z,A,y)},"MessengerReactions.react")}.bind(this),s}q.prototype.render=function(){__p&&__p();var r,s=this.props,t=s.message,u=s.participants,v=s.renderQuickAdd,w=s.hovered,x=t.reactions,y=t.attachments,z=y&&y.length===1&&c("MercuryConfig").MNFWD&&x&&Object.keys(x).length===0;if(z&&y[0].attach_type===c("MercuryAttachmentType").STICKER)return null;if(!w&&z&&y[0].attach_type===c("MercuryAttachmentType").SHARE)return null;if(((r=y[0])!=null?(r=r.share)!=null?(r=r.style_list)!=null?r[0]:r:r:r)===c("StoryAttachmentStyle").MONTAGE_DIRECT)return null;if((!x||!u)&&!v)return null;var A={},B=0,C=false;Object.entries(x||{}).forEach(function(H){var I=H[0],J=H[1];if(typeof J==="string"){if(I===n)C=true;if(!A[J])A[J]=0;A[J]++;B++}});var D=Object.keys(A).sort(c("MessengerReactionsUtil").sortFunction).slice(0,o).map(function(H,I,x){return c("React").createElement("span",{className:"_4kf5",style:{zIndex:x.length-I,marginLeft:I===0?0:"-4px"},key:H},c("React").createElement(c("MessengerTextWithEmoticons.react"),{customSize:true,renderEmoticons:true,renderEmoji:true,text:H}))}),E=B>0?c("React").createElement("span",{className:"_4kf5 _4kf6"+(C?" _fy2":"")},B):null,F=v&&!C?c("React").createElement("div",{className:"_aou _aov"},c("React").createElement("span",{className:"_aow"},c("React").createElement(c("MessengerReactionsPrompt.react"),{message:t,messageIsSelected:true,isQuickAdd:true,useChatEmojiReact:c("MercuryConfig").MCER}))):null,G=c("TooltipData").propsFor(this.$MessengerReactions1());return c("React").createElement("div",babelHelpers["extends"]({},G,{className:"_4kf7 preview"}),c("React").createElement(c("ShimButton.react"),{className:"_aou",onClick:this.$MessengerReactions2},D,E),F)};q.prototype.$MessengerReactions1=function(){__p&&__p();var r=this.props.message.reactions,s=this.props.participants;if(!r||!s)return"";var t=Object.keys(r),u=t.reduce(function(u,y){if(u.length>=p)return u;var z=c("MercuryIDs").getParticipantIDFromUserID(y),A=s.get(z)||c("MercuryParticipants").getNow(z),B=A&&A.name;if(B)u.push(B);return u},[]),v=u.length,w=u.join("\n");if(t.length>v){var x=i._("and {count} other(s)",[i.param("count",t.length-v)]);w+="\n"+x.toString()}return w};q.propTypes={isFromViewer:l.bool.isRequired,message:l.object.isRequired,participants:l.object,renderQuickAdd:l.bool,hovered:l.bool};f.exports=q}),null);