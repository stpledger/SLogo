if (self.CavalryLogger) { CavalryLogger.start_js(["YwjT\/"]); }

__d("MessengerThreadlistReact.bs",["cx","csx","fbt","bs_array","bs_block","bs_curry","React","Utils.bs","Parent","gkx","ReactDOM","debounce","LinkReact.bs","UserAgent","bs_caml_array","MercuryIDs","bs_pervasives","CurrentUser","ReasonReact.bs","bs_js_primitive","MessagingTag","MercuryConfig","MessengerView","MercuryFilters","MessengerActions","MercuryThreadInfo","KeyEventController","MessageRequestLogger.bs","SubscriptionsHandler","ChatSidebarSheetReact.bs","MessengerSpinnerReact.bs","MessengerTypeaheadUtils","MessengerComposerActions","MercuryTypeaheadConstants","MessengerSearchFunnelLogger","WorkChatThreadlistTabsReact.bs","MessengerNewMessagesNoticeReact.bs","MessengerThreadlistLinkRowReact.bs","MessengerFlexScrollableAreaReact.bs","WorkchatThreadListInviteRowReact.bs","MessengerMessageRequestsInfoReact.bs","MessengerThreadListGridWrapperReact.bs","MessengerGraphQLSearchTypeaheadReact.bs","MessengerSearchFunnelLoggerConstants","MessengerThreadlistRowContainerReact.bs","MessengerThreadlistNewMessageRowReact.bs","WorkChatThreadlistNewsfeedActionReact.bs","MessengerThreadlistMessageRequestsRowReact.bs","workchatThreadlistGroupCarouselContainerReact.bs"],(function aa(ba,a,ca,da,ea,b,fa,ga,c){"use strict";__p&&__p();function d(p,q,r){if(r)if(p.length>0&&q.length>0){var s=a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(p,0),0),t=a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(q,0),0);if(s.unread_count>0&&s.thread_id!==r[0]&&s!==t)return+a("MercuryThreadInfo").isMuted(s);else return 0}else return 0;else return 0}function e(p,q){var r=+p.ctrlKey,s=+p.metaKey,t=+p.shiftKey,u=+a("KeyEventController").filterEventTypes(p,q),v=+a("KeyEventController").filterEventTargets(p,q),w=a("Parent").bySelector(p.target,"._150g");if(r!==0||s!==0||t!==0||!(u!==0&&v!==0&&w==null))return 0;else return 1}function f(p,q){__p&&__p();var r=+p.ctrlKey,s=+p.metaKey,t=+a("UserAgent").isPlatform("Mac OS X"),u=+a("UserAgent").isPlatform("iOS"),v=+a("KeyEventController").filterEventTypes(p,q),w=a("Parent").bySelector(p.target,"._150g");if(r!==0)if(s!==0||t!==0||u!==0||!(v!==0&&w==null))return 0;else return 1;else if(s!==0)if(t!==0)if(u!==0||!(v!==0&&w==null))return 0;else return 1;else if(u!==0&&v!==0&&w==null)return 1;else return 0;else return 0}var g=a("UserAgent").isPlatform("Mac OS X")||a("UserAgent").isPlatform("iOS")?"Cmd":"Ctrl",h="K",i=g+" + K";function j(p,q,r){__p&&__p();var s=r.findIndex(function(u){__p&&__p();var v=u.length;if(v!==1)if(v!==0&&p&&a("bs_caml_array").caml_array_get(u,0).thread_id===p[0])return 1;else return 0;else{var w=u[0];if(p&&w.thread_id===p[0])return 1;else return 0}}),t=a("bs_pervasives").min(a("bs_pervasives").max(s+q|0,0),r.length-1|0);return a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(r,t),0).thread_id}function k(p,q){p.preventDefault();var r=q[1][4][0];if(r)return r[0].focusInput();else return 0}function ha(p,q){q[1][4][0]=p==null?0:[p];return 0}function l(p,q){var r=q[1][6];if(r){a("MessengerTypeaheadUtils").scrollEntryIntoView(p,r[0]);return 0}else return 0}function ia(p){p.preventDefault();a("MessengerActions").changeFolder(a("MessagingTag").OTHER);return 0}function ja(p){p.preventDefault();a("MessengerActions").changeFilter(a("MercuryFilters").ALL);a("MessengerActions").changeFolder(a("MessagingTag").INBOX);return 0}function m(p,q,r,s){__p&&__p();var t=[];a("bs_array").iter(function(w){__p&&__p();var x=q[w];if(x!==undefined){var y=x[1],z=x[0];if(z==null)return 0;else{var A=a("ReactDOM").findDOMNode(z).getBoundingClientRect();if(A.top>p.top-10&&A.bottom<p.bottom+10){t.push({threadID:y.thread_id,unread:+(y.unread_count>0)});return 0}else return 0}}else return 0},Object.keys(q));if(t.length){var u=a("bs_array").map(function(w){return a("MercuryIDs").getThreadKeyfromThreadIDUserID(w.threadID,s)},t),v=u.join(",");return a("MessageRequestLogger.bs").logItemImpression(t,v,r)}else return 0}var n=a("debounce")(function(p){var q=p[1],r=p[0],s=r[6];if(s){var t=s[0].getArea().getElement().getBoundingClientRect();m(t,r[7],a("MessagingTag").PENDING,q);return m(t,r[8],a("MessagingTag").OTHER,q)}else return 0},500);function ka(p,q,r,s){var t=q[1],u=t[0],v=u&&u[0]===a("bs_caml_array").caml_array_get(s,0).thread_id?true:false;return a("ReasonReact.bs").element([a("bs_caml_array").caml_array_get(s,0).thread_id],0,a("MessengerThreadlistMessageRequestsRowReact.bs").make(r,v,function(w){return a("bs_curry")._1(q[3],a("bs_block").__(3,[w]))},[],s,p,[]))}function la(p,q,r){__p&&__p();var s=r[1];if(p.folder===a("MessagingTag").PENDING){s[7][p.thread_id]=[q,p];return 0}else if(p.folder===a("MessagingTag").OTHER){s[8][p.thread_id]=[q,p];return 0}else return 0}function ma(p,q,r,s,t,u){var v=r[1],w=p&&p[0]===u.thread_id?1:0,x=v[0],y=x?1:0,z=v[0],A=z&&z[0]===u.thread_id?1:0,B=w!==0?y!==0&&A===0?0:1:A!==0?1:0,C=+(u.folder===a("MessagingTag").PENDING||u.folder===a("MessagingTag").OTHER);return a("ReasonReact.bs").element([u.thread_id],[C!==0?a("bs_curry")._1(r[0],function(D,E){return la(u,D,E)}):function(){return 0}],a("MessengerThreadlistRowContainerReact.bs").make([s],[w],[A],[v[2]],[B],function(D){return a("bs_curry")._1(r[3],a("bs_block").__(3,[D]))},a("bs_curry")._1(r[0],l),u,q,t,[]))}function na(p,q){var r=p[1],s=p[0],t=r==null?a("MessengerSearchFunnelLoggerConstants").OTHER:r===a("MercuryTypeaheadConstants").FRIEND_TYPE?a("MessengerSearchFunnelLoggerConstants").USER_CONTACT:r===a("MercuryTypeaheadConstants").NON_FRIEND_TYPE?a("MessengerSearchFunnelLoggerConstants").USER_NON_CONTACT:r===a("MercuryTypeaheadConstants").FB4C_TYPE?a("MessengerSearchFunnelLoggerConstants").COWORKER:r===a("MercuryTypeaheadConstants").GAME_TYPE?a("MessengerSearchFunnelLoggerConstants").GAME:r===a("MercuryTypeaheadConstants").INTERNAL_BOT_PAGE_TYPE||r===a("MercuryTypeaheadConstants").COMMERCE_PAGE_TYPE||r===a("MercuryTypeaheadConstants").MEETING_ROOM_PAGE_TYPE||r===a("MercuryTypeaheadConstants").PAGE_TYPE?a("MessengerSearchFunnelLoggerConstants").PAGE:r===a("MercuryTypeaheadConstants").THREAD_TYPE?a("MessengerSearchFunnelLoggerConstants").GROUP:a("MessengerSearchFunnelLoggerConstants").OTHER;a("MessengerActions").selectThread(s,r);a("MessengerSearchFunnelLogger").logResultSelection("WWW_MESSENGER_SEARCH_SESSION_FUNNEL",q[1][3],s,t);return 0}var o=a("ReasonReact.bs").reducerComponentWithRetainedProps("MessengerThreadlistReact");function oa(p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,ra){__p&&__p();var F=function F(G,H,I){__p&&__p();var J=I[2],B=J[0],K=typeof G==="number"?G!==0?B.length-1|0:(-B.length|0)-1|0:G[0],L=+H.altKey,M=a("Parent").bySelector(H.target,"._4rv3"),N=I[1][0],O=a("Parent").bySelector(H.target,"._1ht1"),P=0;if(L!==0)if(M==null)P=1;else{var Q=J[4];if(Q!==0)if(K===1&&B.length>0){a("MessengerActions").selectThread(a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(B,0),0).thread_id,null);return 0}else return 0;else{var R=B.findIndex(function(T){if(T.length!==1)return 0;else{var U=T[0],L=J[2];if(L&&L[0]===U.thread_id)return 1;else return 0}});if(R!==-1){var S=a("bs_caml_array").caml_array_get(B,R+K|0);a("MessengerActions").selectThread(a("bs_caml_array").caml_array_get(S,0).thread_id);if(J[1]&&R===0&&K===-1)a("MessengerActions").changeDetailView(a("MessengerView").DETAIL.COMPOSE);if(R===(B.length-1|0))return a("bs_curry")._1(J[3],0);else return 0}else return 0}}else P=1;if(P===1)if(N&&!(O==null)){H.preventDefault();return a("bs_curry")._1(I[3],a("bs_block").__(4,[K]))}else return 0},sa=function sa(G,ra){__p&&__p();G.stopPropagation();a("MessengerComposerActions").exitComposeState();if(w){var H=B.find(function(I){var J=I.length;if(J!==1)if(J!==0)return+(a("bs_js_primitive").undefined_to_opt(I.find(function(H){return+(H.unread_count===0)}))===0);else return 0;else{var K=I[0];return+(K.unread_count===0)}});a("MessengerActions").selectThread(H!==undefined?a("bs_caml_array").caml_array_get(H,0).thread_id:null,null);return 0}else return 0},ta=function ta(G,ra){G.preventDefault();return a("bs_curry")._1(y,0)},ua=function ua(u,v,E,G){__p&&__p();var H=0,I=0;if(E!==0)return null;else if(u)if(u[0]!==0)return null;else I=2;else I=2;if(I===2)if(v)if(v[0]!==0)return a("React").createElement("div",{className:"_19hf"},a("ReasonReact.bs").element(0,0,a("MessengerSpinnerReact.bs").make(0,0,0,[])));else H=1;else H=1;if(H===1)return a("React").createElement("div",{className:"_19hf"},a("ReasonReact.bs").element(0,0,a("LinkReact.bs").make(0,0,0,0,0,0,["#"],0,[a("bs_curry")._1(G[0],ta)],0,0,0,0,[-1],0,0,[c._("Show Older")])))},va=function va(G){__p&&__p();if(B.length)return a("ReasonReact.bs").element(0,0,a("MessengerThreadListGridWrapperReact.bs").make(c._("Conversation List"),[a("bs_array").map(function(M){if(M.length!==1)return ka(C,G,D,M);else{var N=M[0];return ma(p,C,G,s,E,N)}},B)]));else{var H;if(s===a("MessagingTag").INBOX){var I=+(r===a("MercuryFilters").UNREAD);H=I!==0?c._("No unread messages found."):c._("No messages found.")}else if(s===a("MessagingTag").PENDING){var J=+a("MercuryConfig").RTCR;H=J!==0?c._("No Connection requests found."):c._("No Message requests found.")}else H=c._("No filtered requests found.");var K=+(s!==a("MessagingTag").INBOX||r!==a("MercuryFilters").ALL),L=K!==0?a("ReasonReact.bs").element(0,0,a("LinkReact.bs").make(0,0,0,0,0,0,0,0,[ja],0,0,0,0,0,0,0,[c._("Return to inbox.")])):null;return a("React").createElement("div",{className:"_3blk"},H,a("React").createElement("div",{className:"_3bll"},L))}};return[o[0],o[1],o[2],function(G){__p&&__p();var H=G[2],I=G[1];if(H[5]!==s||E!==H[6])n([I,C]);var J=I[6],K=J?+J[0].isScrolledToTop():0,L=d(B,H[0],p),M=0;if(K!==0)M=1;else if(L!==0)if(z){var N=z[0],O=I.slice(),P=+(N.length===0);O[3]=P!==0?N:I[3];O[5]=1;return O}else return I;else M=1;if(M===1)if(z){var Q=z[0],R=I.slice(),S=+(Q.length===0);R[3]=S!==0?Q:I[3];R[5]=I[5]&&1-K;return R}else return I},function(G){n([G[1],C]);return 0},function(G){var H=G[1],I=G[0],J=+(H[1][1]!==I[1][1]),K=t&&1-I[2][1],L=H[1][6];if(J!==0&&K!==0&&L){L[0].scrollToTop();return 0}else return 0},o[6],o[7],o[8],function(G){__p&&__p();var H=G[1],I=H[5]&&1-H[1],J=+a("CurrentUser").isWorkUser()&&1-H[1]&&+(a("gkx")("AT58O0ueTgrNywfhkMH9fYHs8_paoL8Uj3nAzEseDtJbi75rIYW1Jld0CDq2Sj1iPDsNcWsScyu5Jv7kTxxdRT_i")&&s===a("MessagingTag").INBOX),K=c._("Conversations"),L=z?1:0,M=+(s===a("MessagingTag").INBOX),N;if(M!==0){var O=+a("CurrentUser").isWorkUser(),P;if(O!==0){var Q=H[1];P=c._("Search chats{keyboard shortcut help}",[c.param("keyboard shortcut help",Q!==0?"":" ("+(i+")"))])}else P=c._("Search Messenger");N=a("ReasonReact.bs").element(0,[a("bs_curry")._1(G[0],ha)],a("MessengerGraphQLSearchTypeaheadReact.bs").make("_5iwm"+(H[1]||+(H[3].length>0)?" _5iwn":"")+" _150g",1,0,0,0,[+(H[3]==="")&&1-L],[L],[H[1]],function(){a("MessengerSearchFunnelLogger").endFunnel("WWW_MESSENGER_SEARCH_SESSION_FUNNEL");return a("bs_curry")._1(G[3],1)},function(Y){return a("bs_curry")._1(G[3],a("bs_block").__(1,[Y.target.value]))},function(){a("MessengerSearchFunnelLogger").logClearQuery("WWW_MESSENGER_SEARCH_SESSION_FUNNEL");if(q)a("bs_curry")._1(q[0],0);return a("bs_curry")._1(G[3],2)},function(){a("MessengerSearchFunnelLogger").startFunnel("WWW_MESSENGER_SEARCH_SESSION_FUNNEL",a("MessengerSearchFunnelLoggerConstants").MESSENGER_DOT_COM,a("MessengerSearchFunnelLoggerConstants").UNIVERSAL_SEARCH);return a("bs_curry")._1(G[3],0)},a("bs_curry")._1(G[0],l),function(Y,Z){return a("bs_curry")._2(G[0],na,[Y,Z])},P,[H[3]],1,1,"_11_d",C,[]))}else N=null;var R=+a("CurrentUser").isWorkUser()&&1-H[1],S=+(s===a("MessagingTag").PENDING),T=+(s===a("MessagingTag").INBOX&&x.length>0),U=+(s===a("MessagingTag").PENDING),V=+a("CurrentUser").isWorkUser(),W;if(V!==0){var X=+a("gkx")("AT5ad75lfUu_LEQloT_GHl5l4DgqBru4g1KtvnZgqgchaE21iYmpzSvKrpk6THSFyobb17PT_X_4ySOjfDebuqUc");W=X!==0?a("ReasonReact.bs").element(0,0,a("WorkChatThreadlistTabsReact.bs").make([r],[s],a("MessengerView").MASTER.RECENT,C,[])):a("ReasonReact.bs").element(0,0,a("WorkChatThreadlistNewsfeedActionReact.bs").make([]))}else W=null;return a("React").createElement("div",{className:"_2xhi"},a("ReasonReact.bs").element(0,0,a("ChatSidebarSheetReact.bs").make("_p0g",[])),a("ReasonReact.bs").element(0,0,a("MessengerNewMessagesNoticeReact.bs").make(I,function(Y){Y.preventDefault();return a("bs_curry")._1(G[3],4)},0,[])),a("ReasonReact.bs").element(0,[function(Y){return a("bs_curry")._1(G[3],a("bs_block").__(0,[Y==null?0:[Y]]))}],a("MessengerFlexScrollableAreaReact.bs").make([function(){return a("bs_curry")._1(G[3],3)}],[N,R!==0?a("ReasonReact.bs").element(0,0,a("WorkchatThreadListInviteRowReact.bs").make([])):null,J!==0?a("ReasonReact.bs").element(0,0,a("workchatThreadlistGroupCarouselContainerReact.bs").make(C,[])):null,J!==0?a("React").createElement("div",undefined,a("React").createElement("span",{className:"_1p5i"},c._("Recent"))):null,S!==0?a("ReasonReact.bs").element(0,0,a("MessengerMessageRequestsInfoReact.bs").make([])):null,a("React").cloneElement(a("React").createElement("div",{className:H[1]&&1-L?"accessible_elem":"",role:"navigation"}),{"aria-label":K},T!==0?a("ReasonReact.bs").element(0,0,a("MessengerThreadlistMessageRequestsRowReact.bs").make(D,false,function(Y){return a("bs_curry")._1(G[3],a("bs_block").__(3,[Y]))},x,[],C,[])):null,t!==0?a("ReasonReact.bs").element(0,0,a("MessengerThreadlistNewMessageRowReact.bs").make(w,a("bs_curry")._1(G[0],sa),[])):null,va(G),U!==0?a("MessengerThreadlistLinkRowReact.bs").make(ia):null,A?a("bs_curry")._1(A[0],0):ua(u,v,E,G))])),W)},function(){return[0,0,0,"",[0],0,0,{},{}]},[B,t,p,y,w,s,E],function(G,H){__p&&__p();if(typeof G==="number")switch(G){case 0:var I=H.slice();return a("bs_block").__(0,[(I[1]=1,I)]);case 1:var J=H.slice();return a("bs_block").__(0,[(J[1]=0,J[3]="",J)]);case 2:var K=H.slice();return a("bs_block").__(0,[(K[3]="",K)]);case 3:if(H[1])return 0;else{var L=H[6];if(L){var M=L[0],N=+M.isScrolledToBottom(),O=+M.isScrolledToTop(),P=H[5];if(N!==0){var Q=0;if(O!==0)if(P!==0){var R=H.slice();return a("bs_block").__(3,[(R[5]=0,R),function($){a("bs_curry")._1(y,0);return n([$[1],C])}])}else Q=1;else Q=1;if(Q===1)return a("bs_block").__(2,[function($){a("bs_curry")._1(y,0);return n([$[1],C])}])}else{var S=0;if(O!==0)if(P!==0){var T=H.slice();return a("bs_block").__(3,[(T[5]=0,T),function($){return n([$[1],C])}])}else S=1;else S=1;if(S===1)return a("bs_block").__(2,[function($){return n([$[1],C])}])}}else return 0}break;case 4:var U=H.slice();return a("bs_block").__(3,[(U[5]=0,U),function($){var L=$[1][6];if(L){L[0].scrollToTop();return 0}else return 0}])}else switch(G.tag|0){case 0:var V=H.slice();return a("bs_block").__(1,[(V[6]=G[0],V)]);case 1:var W=H.slice();return a("bs_block").__(0,[(W[3]=G[0],W)]);case 2:var X=H.slice();return a("bs_block").__(0,[(X[2]=G[0],X)]);case 3:var Y=H.slice();return a("bs_block").__(0,[(Y[0]=[G[0]],Y)]);case 4:var Z=H.slice();return a("bs_block").__(0,[(Z[0]=[j(H[0],G[0],B)],Z)])}},function(G){__p&&__p();return[[function(){__p&&__p();var H=function H(N,O){O.preventDefault();return a("bs_curry")._1(G[3],a("bs_block").__(2,[N]))},I=new(a("SubscriptionsHandler"))(),J=[-1],K=[1],L=[-5],M=[5];I.addSubscriptions(a("KeyEventController").registerKey("UP",a("bs_curry")._1(G[0],function(N,O){return F(J,N,O)}),e),a("KeyEventController").registerKey("DOWN",a("bs_curry")._1(G[0],function(N,O){return F(K,N,O)}),e),a("KeyEventController").registerKey("PAGE_UP",a("bs_curry")._1(G[0],function(N,O){return F(L,N,O)})),a("KeyEventController").registerKey("PAGE_DOWN",a("bs_curry")._1(G[0],function(N,O){return F(M,N,O)})),a("KeyEventController").registerKey("HOME",a("bs_curry")._1(G[0],function(N,O){return F(0,N,O)})),a("KeyEventController").registerKey("END",a("bs_curry")._1(G[0],function(N,O){return F(1,N,O)})),a("KeyEventController").registerKey("LEFT",function(N){return H(0,N)}),a("KeyEventController").registerKey("RIGHT",function(N){return H(1,N)}),a("KeyEventController").registerKey(h,a("bs_curry")._1(G[0],k),f));return I},function(H){H.release();return 0}],0]},o[14]]}var pa=a("ReasonReact.bs").wrapReasonForJs(o,function(p){var q=a("Utils.bs").nullUndefinedBooleanToOptionBool(p.isComposing);return oa(a("bs_js_primitive").null_undefined_to_opt(p.activeThreadID),a("bs_js_primitive").null_undefined_to_opt(p.clearQuery),p.filter,p.folder,q?q[0]:0,a("Utils.bs").nullUndefinedBooleanToOptionBool(p.isLoaded),a("Utils.bs").nullUndefinedBooleanToOptionBool(p.isLoading),+p.isNewMessageActive,p.newMessageRequestThreads,p.onLoadMoreRequest,a("bs_js_primitive").null_undefined_to_opt(p.queryString),a("bs_js_primitive").null_undefined_to_opt(p.renderLoadMore),a("bs_array").map(function(r){return[].concat(r)},p.threads),p.viewer,p.onAggregationClick,+p.showAggregation,[])}),qa=10;b.hasNewUnreadMessages=d;b.filterKeyEvent=e;b.filterPlatformSpecificModifierKey=f;b.platformSpecificModiferKeyLabel=g;b.searchKeyboardMainKey=h;b.searchKeyboardShortcut=i;b.getFocusedThreadId=j;b.handleFocusSearchBar=k;b.setSearchInputNode=ha;b.handleScrollIntoView=l;b.handleFilteredRequestsClick=ia;b.handleReturnToInboxClick=ja;b.impressionOffset=qa;b.logNodeImpressions=m;b.checkAndUpdateMessageRequestImpressions=n;b.renderAggregatedRequests=ka;b.setter=la;b.renderThread=ma;b.handleSelect=na;b.component=o;b.make=oa;b.jsComponent=pa}),null);