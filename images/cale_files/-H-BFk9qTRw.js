if (self.CavalryLogger) { CavalryLogger.start_js(["8WqOB"]); }

__d("BootloadOnInteraction",["Event","JSResource","emptyFunction"],(function a(b,c,d,e,f,g){var h={mount:function i(j,k){var l=arguments.length<=2||arguments[2]===undefined?c("emptyFunction"):arguments[2],m=arguments.length<=3||arguments[3]===undefined?c("emptyFunction"):arguments[3],n=[c("Event").listen(j,"mouseover",o),c("Event").listen(j,"focus",o)];function o(){n.forEach(function(p){return p.remove()});m();c("JSResource").loadAll(k,l)}}};f.exports=h}),null);
__d("MercuryJewelBootloadModules",["BootloadOnInteraction","JSResource","emptyFunction"],(function a(b,c,d,e,f,g){__p&&__p();var h=null,i=[c("JSResource")("MercuryJewel").__setRef("MercuryJewelBootloadModules"),c("JSResource")("MercuryOrderedThreadlist").__setRef("MercuryJewelBootloadModules"),c("JSResource")("MercuryThreadInformer").__setRef("MercuryJewelBootloadModules"),c("JSResource")("MercuryThreads").__setRef("MercuryJewelBootloadModules"),c("JSResource")("Toggler").__setRef("MercuryJewelBootloadModules"),c("JSResource")("MessengerGraphQLThreadlistFetcher.bs").__setRef("MercuryJewelBootloadModules"),c("JSResource")("MercuryServerRequests").__setRef("MercuryJewelBootloadModules")];function j(m,n){h=h||new m(n,n.bootload_args)}function k(m,n){j(m,n);n.inform("opened")}var l={mount:function m(n){var o=arguments.length<=1||arguments[1]===undefined?c("emptyFunction"):arguments[1],p=n.getButton();c("BootloadOnInteraction").mount(p,i,function(q){k(q,n)},function(){o()})},load:function m(n){c("JSResource").loadAll(i,function(o){k(o,n)})},loadModules:function m(n){c("JSResource").loadAll(i,function(o){j(o,n)})}};f.exports=l}),null);
__d("bs_js_dict",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=function h(n,o){delete n[o];return 0};function i(n){var o=Object.keys(n),p=o.length,j=new Array(p);for(var q=0,r=p-1|0;q<=r;++q){var s=o[q];j[q]=[s,n[s]]}return j}function j(n){var o=Object.keys(n),p=o.length,q=new Array(p);for(var r=0,s=p-1|0;r<=s;++r)q[r]=n[o[r]];return q}function k(i){__p&&__p();var n={},o=i;while(true){var p=o;if(p){var q=p[0];n[q[0]]=q[1];o=p[1];continue}else return n}}function l(i){var n={},o=i.length;for(var p=0,q=o-1|0;p<=q;++p){var r=i[p];n[r[0]]=r[1]}return n}function m(n,o){var p={},q=Object.keys(o),r=q.length;for(var s=0,t=r-1|0;s<=t;++s){var u=q[s];p[u]=n(o[u])}return p}g.unsafeDeleteKey=h;g.entries=i;g.values=j;g.fromList=k;g.fromArray=l;g.map=m}),null);
__d("bs_js_types",["bs_block"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k){__p&&__p();if(typeof k==="undefined")return[0,k];else if(k===null)return[1,k];else if(typeof k==="number")return[3,k];else if(typeof k==="string")return[4,k];else if(typeof k==="boolean")return[2,k];else if(typeof k==="function")return[5,k];else if(typeof k==="object")return[6,k];else return[7,k]}function i(k){__p&&__p();var l=typeof k;if(l==="undefined")return 3;else if(k===null)return 2;else if(l==="number")return c("bs_block").__(0,[k]);else if(l==="string")return c("bs_block").__(1,[k]);else if(l==="boolean")if(k===true)return 1;else return 0;else if(l==="function")return c("bs_block").__(2,[k]);else if(l==="object")return c("bs_block").__(3,[k]);else return c("bs_block").__(4,[k])}function j(k,l){switch(l){case 0:return+(typeof k==="undefined");case 1:return+(k===null);case 2:return+(typeof k==="boolean");case 3:return+(typeof k==="number");case 4:return+(typeof k==="string");case 5:return+(typeof k==="function");case 6:return+(typeof k==="object");case 7:return+(typeof k==="symbol")}}g.reify_type=h;g.test=j;g.classify=i}),null);
__d("FBID.bs",["invariant","bs_js_exn","bs_string","gkx","bs_js_types","bs_js_boolean"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(l){if(c("gkx")("AT5AGDWr7VWKZPg1PvTz69G07vIW7nWrxrA4PloGCgjyPuof8r7WUUsWLIKzWOZMmcJyN6U1BeEUXZmBqPUEAKAe")){c("bs_js_boolean").to_js_boolean(c("bs_js_types").test(l,4))||h(0);c("bs_js_boolean").to_js_boolean(+(l!=="0"))||h(0);var m=/^[0-9]+$/;c("bs_js_boolean").to_js_boolean(+m.test(l))||h(0)}return l}function j(l){try{return[i(l)]}catch(m){var n=c("bs_js_exn").internalToOCamlException(m);if(n[0]===c("bs_js_exn").$$Error)return 0;else throw n}}var k=c("bs_string").compare;g.compare=k;g.ofString=j;g.ofStringExn=i}),null);
__d("DisplayGenderConst",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({UNKNOWN:"UNKNOWN",FEMALE:"FEMALE",MALE:"MALE",NEUTER:"NEUTER"})}),null);
__d("MessengerServerPayloadTransformer.bs",["URI","FBID.bs","bs_array","Utils.bs","bs_string","getByPath","bs_caml_array","bs_js_boolean","MercuryIDs","bs_caml_format","GenderConst","bs_js_primitive","WorkModeConfig","bs_js_null_undefined","DisplayGenderConst","MessagingThreadType","MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs","MessengerThreadCannotReplyReason"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();function c(f){__p&&__p();var g=f.location_coordinates,h=g==null?[null,null]:[g.latitude,g.longitude],i=f.location_page,j;if(i==null)j=null;else{var k=i.address;j=k==null?null:k.full_address}var l=f.allows_rsvp,m=l!==0?1:0,n=a("bs_array").fold_left(function(p,q){p[q.node.id]=q.guest_list_state;return p},{},f.event_reminder_members.edges),o=f.lightweight_event_creator;return{creator_id:o==null?null:o.id,event_members:n,event_time:f.time,event_type:f.lightweight_event_type,latitude:h[0],longitude:h[1],location_address:j,location_name:f.location_name,note:f.note,oid:f.id,related_event:f.related_event,repeat_mode:f.repeat_mode,seconds_to_notify_before:f.seconds_to_notify_before,status:f.lightweight_event_status,title:f.event_title,track_rsvp:m}}function d(f){__p&&__p();var g=f.associated_object;if(g==null)return null;else{var h=g.action_link,i;if(h==null)i=null;else{var j=+a("WorkModeConfig").is_work_user,k=j!==0?a("WorkModeConfig").company_subdomain+".facebook.com":"www.facebook.com";i=new(a("URI"))(h).setDomain(k)}var l=g.profile_picture;return{id:g.id,name:g.name,action_link:i,profile_picture:l==null?null:{uri:l.uri},room_type:g.room_type,privacy_mode:g.privacy_mode,approval_mode_toggleable:g.approval_mode_toggleable,start_timestamp:g.start_timestamp,event_place:g.event_place,mentorship_program:g.mentorship_program}}}function fa(f){var g=f.related_page_thread;if(g==null)return null;else{var h=a("bs_array").map(function(k){return k.name},g.custom_thread_tags.nodes),i=g.page,j=i==null?null:i.id;return{flagged:g.is_flagged,pageID:j,customTagNames:h}}}function ga(f){__p&&__p();var g=f.thread_key.other_user_id;if(g==null)return 0;else{var h=f.all_participants.nodes;return a("bs_array").fold_left(function(i,j){var k=j.messaging_actor;if(k.id===g)return+(k.__typename==="User");else return i},0,h)}}function ha(f){__p&&__p();if(f.length){var g={};a("bs_array").iter(function(h){var i=h.nickname;if(i==null)return 0;else{g[h.participant_id]=i;return 0}},f);return g}else return null}function ia(f){if(!(f==null)&&f!=="")return"#"+a("bs_string").sub(f,2,f.length-2|0);else return null}function ja(f){return f.thread_key.thread_fbid}function ka(f){return f.thread_key.other_user_id}function la(f){return a("bs_js_primitive").null_undefined_to_opt(a("getByPath")(f,["messages","page_info"]))}function e(f){__p&&__p();var g=f.gender,h=f.url,i;if(h==null)i=null;else{var j=+a("WorkModeConfig").is_work_user,k=j!==0?a("WorkModeConfig").company_subdomain+".facebook.com":"www.facebook.com";i=new(a("URI"))(h).getUnqualifiedURI().setDomain(k).setProtocol("https").toString()}var l=f.big_image_src,m=f.big_image_src,n=f.__typename,o;switch(n){case"Page":o="page";break;case"User":o="user";break;default:o=null}var p=f.accepts_messenger_user_feedback,q=f.is_viewer_friend,r=f.is_messenger_user,s=f.is_verified,t=f.is_messenger_platform_bot,u=f.is_message_blocked_by_viewer,v=f.is_viewer_subscribed_to_message_updates,w=f.is_viewer_coworker,x=f.scim_company_user,y;if(x==null)y=null;else{var z=x.company_title;if(z==="")y=null;else{var A=a("bs_js_null_undefined").bind(f.work_info,function(D){return a("bs_js_null_undefined").bind(D.work_community,function(E){return E.name})}),B=a("Utils.bs").nullUndefinedBooleanToOptionBool(f.is_viewer_coworker);y=!(A==null)&&B&&B[0]===0?""+(String(z)+(" \u2022 "+(String(A)+""))):z}}var C=f.is_employee;return{id:"fbid:"+f.id,fbid:f.id,gender:g==null?a("GenderConst").NOT_A_PERSON:g===a("DisplayGenderConst").MALE?a("GenderConst").MALE_SINGULAR:g===a("DisplayGenderConst").FEMALE?a("GenderConst").FEMALE_SINGULAR:a("GenderConst").NOT_A_PERSON,href:i,image_src:l==null?null:l.uri,big_image_src:m==null?null:m.uri,name:f.name,short_name:a("Utils.bs").$pipe$unknown(a("bs_js_primitive").null_undefined_to_opt(f.short_name),f.name),type:o,vanity:f.username,accepts_messenger_user_feedback:p==null?false:p,is_friend:q==null?false:q,is_messenger_user:r==null?false:r,is_business_enabled:f.__typename==="Page"?true:false,is_verified:s==null?false:s,is_messenger_platform_bot:t==null?false:t,is_messenger_ignored:null,is_messenger_blocked:u==null?false:u,is_subscribed_to_page_updates:v==null?true:v,is_coworker:w==null?true:w,title:y,employee:C==null?false:C,instant_game_channel:f.__typename==="Page"?f.instant_game_channel:null}}function ma(f){return a("bs_array").map(function(g){return e(g.messaging_actor)},f.all_participants.nodes)}function na(f,g){__p&&__p();var h=g.read_receipts;if(h==null)return 0;else{var i={};a("bs_array").iter(function(j){var h=j.actor;if(!(h==null)&&f!==h.id){i[h.id]={action:a("bs_caml_format").caml_float_of_string(j.action),watermark:a("bs_caml_format").caml_float_of_string(j.watermark)};return 0}else return 0},h.nodes);return[i]}}function oa(f){__p&&__p();var g=f.delivery_receipts;if(g==null)return[];else return g.nodes.sort(function(h,i){var j=a("bs_caml_format").caml_float_of_string(h.timestamp_precise),k=a("bs_caml_format").caml_float_of_string(i.timestamp_precise);if(j>k)return-1;else if(j===k)return 0;else return 1})}function pa(f,g,h){var i=g.messages;if(i==null)return 0;else return[a("bs_array").map(function(j){return a("MessengerMessageTransformer.bs").transformMessage(f,j,{thread_id:null,thread_fbid:g.thread_key.thread_fbid,other_user_fbid:g.thread_key.other_user_id,folder:a("bs_string").lowercase(g.folder)},h)},i.nodes)]}function qa(f,g,h){__p&&__p();var i=a("bs_array").map(function(Z){var ra=a("MessengerMessageTransformer.bs").unsafeCastBlobAttachments(Z),k=Z.extensible_attachment,$;if(k==null)$=null;else{var l=k.story_attachment;$={legacy_attachment_id:k.legacy_attachment_id,story_attachment:l==null?null:a("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(l)}}return{snippet:Z.snippet,message_sender:Z.message_sender,timestamp_precise:Z.timestamp_precise,commerce_message_type:Z.commerce_message_type,extensible_attachment:$,blob_attachments:ra,sticker:Z.sticker,extensible_message_admin_text:Z.extensible_message_admin_text}},g.last_message.nodes),j={thread_key:g.thread_key,name:g.name,all_participants:g.all_participants,last_message:{nodes:i},unread_count:g.unread_count,message_count:g.messages_count,image:g.image,updated_time_precise:g.updated_time_precise,mute_until:g.mute_until,is_pin_protected:g.is_pin_protected,is_viewer_subscribed:g.is_viewer_subscribed,is_canonical_neo_user:g.is_canonical_neo_user,thread_queue_enabled:g.thread_queue_enabled,folder:g.folder,has_viewer_archived:g.has_viewer_archived,is_page_follow_up:g.is_page_follow_up,cannot_reply_reason:g.cannot_reply_reason,ephemeral_ttl_mode:g.ephemeral_ttl_mode,customization_info:g.customization_info,thread_admins:g.thread_admins,approval_mode:g.approval_mode,joinable_mode:g.joinable_mode,thread_queue_metadata:g.thread_queue_metadata,event_reminders:g.event_reminders,montage_thread:g.montage_thread,last_read_receipt:g.last_read_receipt,related_page_thread:g.related_page_thread,rtc_call_data:g.rtc_call_data,associated_object:g.associated_object,reactions_mute_mode:g.reactions_mute_mode,mentions_mute_mode:g.mentions_mute_mode,privacy_mode:g.privacy_mode,customization_enabled:g.customization_enabled,thread_type:g.thread_type,participant_add_mode_as_string:g.participant_add_mode_as_string,participants_event_status:g.participants_event_status,marketplace_thread_data:g.marketplace_thread_data,page_comm_item:g.page_comm_item,group_approval_queue:g.group_approval_queue},k=j.customization_info,l;if(k==null)l=[null,null,null];else{var m=k.emoji;l=[ia(k.outgoing_bubble_color),m==null?null:{emoji:m},ha(k.participant_customizations)]}var n=j.page_comm_item,o=n==null?[null,null,null,null,null]:[n.comm_status,n.comm_source_id,n.id,n.subtitle,n.comm_item_owners],p=j.last_message.nodes.length?[a("bs_caml_array").caml_array_get(j.last_message.nodes,0)]:0,q=j.last_read_receipt.nodes.length?[a("bs_caml_array").caml_array_get(j.last_read_receipt.nodes,0)]:0,r;if(p){var s=p[0];r=a("MessengerAttachmentTransformer.bs").transformAttachment(f,{extensible_attachment:s.extensible_attachment,blob_attachments:s.blob_attachments,sticker:s.sticker},h)}else r=[];var t;if(p){var u=p[0].extensible_message_admin_text;if(u==null)t=null;else{var v=u.game;t=v==null?null:v.id}}else t=null;var w=j.cannot_reply_reason,x=j.thread_queue_metadata,y=j.thread_type,z=j.montage_thread,A=j.image,B=j.thread_key.other_user_id,C=j.thread_queue_metadata,D=j.name,E=j.thread_key.other_user_id,F;if(E==null){var G=j.thread_key.thread_fbid;F=G==null?null:G}else F=E;var H=j.rtc_call_data,I;if(H==null)I=null;else{var J=H.initiator;I={call_state:H.call_state,server_info_data:H.server_info_data,initiator_fbid:J==null?0:a("bs_caml_format").caml_float_of_string(J.id)}}var K=j.marketplace_thread_data,L;if(K==null)L=null;else{var M=K.for_sale_item,N;if(M==null)N=null;else{var O=M.id,P=M.formatted_price,Q=M.location,R;if(Q==null)R=null;else{var S=Q.reverse_geocode;R={reverse_geocode:S==null?null:{city:S.city,state:S.state}}}var T=M.primary_photo,U;if(T==null)U=null;else{var V=T.image;U=V==null?null:V.uri}N={id:O==null?0:a("bs_caml_format").caml_float_of_string(O),story_id:M.story_id,title:M.group_commerce_item_title,price:P==null?null:P.text,location:R,is_sold:M.is_sold,image_uri:U}}var W=K.buyer,X=K.seller;L={for_sale_item:N,buyer_fbid:W==null?0:a("bs_caml_format").caml_float_of_string(W.id),seller_fbid:X==null?0:a("bs_caml_format").caml_float_of_string(X.id)}}var Y=j.group_approval_queue;return{admin_ids:a("bs_array").map(function(Z){return Z.id},j.thread_admins),approval_mode:j.approval_mode,approval_queue_ids:x==null?[]:a("bs_array").map(function(Z){return a("MercuryIDs").getParticipantIDFromUserID(a("FBID.bs").ofStringExn(Z.id))},x.approval_requests.nodes),can_reply:w==null?true:false,cannot_reply_reason:j.cannot_reply_reason,custom_color:l[0],custom_like_icon:l[1],custom_nickname:l[2],customization_enabled:j.customization_enabled,thread_type:y==null?null:a("bs_js_null_undefined").from_opt(a("bs_js_primitive").undefined_to_opt(a("MessagingThreadType")[y])),participant_add_mode:j.participant_add_mode_as_string,ephemeral_ttl_mode:j.ephemeral_ttl_mode,folder:a("bs_string").lowercase(j.folder),has_email_participant:w==null?false:a("bs_js_boolean").to_js_boolean(+(w===a("MessengerThreadCannotReplyReason").HAS_EMAIL_PARTICIPANT)),has_montage:z==null?false:true,image_src:A==null?null:A.uri,is_archived:a("bs_js_boolean").to_js_boolean(j.has_viewer_archived),is_page_follow_up:a("bs_js_boolean").to_js_boolean(j.is_page_follow_up),is_canonical_user:a("bs_js_boolean").to_js_boolean(ga(j)),is_canonical:B==null?false:true,is_pin_protected:a("bs_js_boolean").to_js_boolean(j.is_pin_protected),is_subscribed:a("bs_js_boolean").to_js_boolean(j.is_viewer_subscribed),is_canonical_neo_user:a("bs_js_boolean").to_js_boolean(j.is_canonical_neo_user),is_thread_queue_enabled:C==null?false:true,joinable_mode:{mode:a("bs_caml_format").caml_int_of_string(j.joinable_mode.mode),link:j.joinable_mode.link},last_message_timestamp:p?a("bs_caml_format").caml_float_of_string(p[0].timestamp_precise):0,last_message_type:p?p[0].commerce_message_type:null,last_read_timestamp:q?a("bs_caml_format").caml_float_of_string(q[0].timestamp_precise):0,lightweight_event:j.event_reminders.nodes.length?c(a("bs_caml_array").caml_array_get(j.event_reminders.nodes,0)):null,message_count:j.message_count,mute_until:j.mute_until,name:D==null?"":D,other_user_fbid:j.thread_key.other_user_id,page_thread_info:fa(j),participants:a("bs_array").map(function(Z){return a("MercuryIDs").getParticipantIDFromUserID(Z.messaging_actor.id)},j.all_participants.nodes),participants_event_status:j.participants_event_status,read_only:w==null?false:a("bs_js_boolean").to_js_boolean(+(w===a("MessengerThreadCannotReplyReason").READ_ONLY)),recipients_loadable:w==null?true:a("bs_js_boolean").to_js_boolean(+(w!==a("MessengerThreadCannotReplyReason").RECIPIENTS_NOT_LOADABLE)),server_timestamp:a("bs_caml_format").caml_float_of_string(j.updated_time_precise),snippet_attachments:r,snippet_sender:p?a("MercuryIDs").getParticipantIDFromUserID(p[0].message_sender.messaging_actor.id):null,snippet:p?p[0].snippet:null,thread_fbid:F,thread_id:"",timestamp:a("bs_caml_format").caml_float_of_string(j.updated_time_precise),unread_count:j.unread_count,rtc_call_data:I,marketplace_thread_data:L,associated_object:d(j),reactions_mute_mode:j.reactions_mute_mode==="REACTIONS_NOT_MUTED"?0:1,mentions_mute_mode:j.mentions_mute_mode==="MENTIONS_NOT_MUTED"?0:1,comm_status:o[0],page_comm_item_id:o[2],comm_source_id:o[1],subtitle:o[3],comm_item_owners:o[4],group_approval_queue:Y==null?null:Y.nodes,game_id:t}}b.getThreadFBID=ja;b.getOtherUserID=ka;b.getMessagePageInfo=la;b.transformParticipant=e;b.transformParticipants=ma;b.transformReadReceipts=na;b.transformDeliveryReceipts=oa;b.transformMessages=pa;b.transformThread=qa}),null);
__d("MessengerThreadsWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1441922175916236"};j.getQueryID=function(){"use strict";return"366167177186241"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("MessengerGraphQLThreadFetcher.bs",["Promise","bs_array","BanzaiODS","bs_caml_array","bs_pervasives","WebGraphQL","bs_js_null_undefined","MessengerThreadsWebGraphQLQuery","MessengerServerPayloadTransformer.bs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k,l,m,n,o){__p&&__p();if(k==null)if(n!==0)return{actions:null,thread:undefined,end_of_history:{type:"user",fbid:l},roger:null};else return{actions:null,thread:undefined,end_of_history:undefined,roger:null};else{var p=c("MessengerServerPayloadTransformer.bs").getThreadFBID(k),q=c("MessengerServerPayloadTransformer.bs").getOtherUserID(k),r=q==null?p==null?c("bs_pervasives").failwith("No thread ID"):p:q;if(r!==l)c("bs_pervasives").failwith("Thread ID mismatch");var s=c("MessengerServerPayloadTransformer.bs").transformThread(m,k,o),t=c("bs_js_null_undefined").from_opt(c("MessengerServerPayloadTransformer.bs").transformMessages(m,k,o)),u=c("MessengerServerPayloadTransformer.bs").transformReadReceipts(m,k),v;if(u){var w={};w[l]=u[0];v=w}else v=null;var x=c("MessengerServerPayloadTransformer.bs").getMessagePageInfo(k);if(x)if(x[0].has_previous_page)return{actions:t,thread:s,end_of_history:undefined,roger:v};else return{actions:t,thread:s,end_of_history:{type:"thread",fbid:l},roger:v};else return{actions:t,thread:s,end_of_history:undefined,roger:v}}}function i(k){return new(c("MessengerThreadsWebGraphQLQuery"))({id:k.id,message_limit:k.limit,load_messages:+(k.limit>0),load_read_receipts:k.loadReadReceipts,before:k.timestamp})}function j(k,l,m){var n=c("bs_array").map(i,l);return c("Promise").all(c("WebGraphQL").execAll(n,{actorID:m?k:null,batchName:"MessengerGraphQLThreadFetcher"}))["catch"](function(o){c("BanzaiODS").bumpEntityKey("messenger_webgraphql","fetch_thread.failure");return c("Promise").reject(o)}).then(function(o){c("BanzaiODS").bumpEntityKey("messenger_webgraphql","fetch_thread.success");return c("bs_array").mapi(function(p,q){var r=q.message_thread,s=c("bs_caml_array").caml_array_get(l,p);return h(r,s.id,k,s.isCanonical,m)},o)})}g._transformPayload=h;g._getQuery=i;g.fetchAll=j}),null);
__d("MessengerThreadlistWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1554766817933352"};j.getQueryID=function(){"use strict";return"196600180934817"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("MessengerGraphQLThreadlistFetcher.bs",["Promise","bs_array","bs_js_dict","BanzaiODS","bs_caml_array","WebGraphQL","bs_caml_format","MessengerServerPayloadTransformer.bs","MessengerThreadlistWebGraphQLQuery"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k){return new(c("MessengerThreadlistWebGraphQLQuery"))({limit:k.limit,before:k.timestamp,tags:k.tags,includeDeliveryReceipts:k.includeDeliveryReceipts,includeSeqID:k.includeSeqID})}function i(k,l,m,n){__p&&__p();var o=[],p=[],q={},r=[],s={},t=[undefined];c("bs_array").iteri(function(u,v){__p&&__p();var w=c("bs_caml_array").caml_array_get(l,u),x=[],y=[],z=[];c("bs_array").iter(function(C){__p&&__p();if(C==null)return 0;else{var D=c("MessengerServerPayloadTransformer.bs").transformThread(k,C,m),E=c("MessengerServerPayloadTransformer.bs").transformParticipants(C);c("bs_array").iter(function(J){s[J.fbid]=J;return 0},E);var F;if(D.is_canonical){var A=D.other_user_fbid;if(A==null)F=null;else{x.push(A);F=A}}else{var B=D.thread_fbid;if(B==null)F=null;else{y.push(B);F=B}}z.push(D.thread_id);o.push(D);if(!(F==null)){var G=c("MessengerServerPayloadTransformer.bs").transformReadReceipts(k,C);if(G)q[F]=G[0]}if(F==null)return 0;else{var H=c("MessengerServerPayloadTransformer.bs").transformDeliveryReceipts(C);if(H.length<1)return 0;else{var I=c("bs_caml_array").caml_array_get(H,0);if(D.is_canonical){r.push({other_user_fbid:F,thread_fbid:null,time:c("bs_caml_format").caml_float_of_string(I.timestamp_precise)});return 0}else{r.push({other_user_fbid:null,thread_fbid:F,time:c("bs_caml_format").caml_float_of_string(I.timestamp_precise)});return 0}}}}},v.viewer.message_threads.nodes);var A=v.viewer.message_threads.sync_sequence_id;if(!(A==null))t[0]=c("bs_caml_format").caml_int_of_string(A);var B=w.timestamp;p.push({start:w.offset,end:B==null?w.offset+w.limit|0:(w.offset+w.limit|0)-1|0,folder:w.folder,other_user_fbids:x,thread_fbids:y,thread_ids:z,filter:w.filter});return 0},n);return{threads:o,ordered_threadlists:p,roger:q,delivery_receipts:r,participants:c("bs_js_dict").values(s),sequence_id:t[0]}}function j(k,l,m){var n=c("bs_array").map(h,l);return c("Promise").all(c("WebGraphQL").execAll(n,{actorID:m?k:null,batchName:"MessengerGraphQLThreadlistFetcher"}))["catch"](function(o){c("BanzaiODS").bumpEntityKey("messenger_webgraphql","fetch_threadlist.failure");return c("Promise").reject(o)}).then(function(o){c("BanzaiODS").bumpEntityKey("messenger_webgraphql","fetch_threadlist.success");return i(k,l,m,o)})}g._getQuery=h;g.transform=i;g.fetchAll=j}),null);