if (self.CavalryLogger) { CavalryLogger.start_js(["uzl3C"]); }

__d("MessengerSharedPhotosReact.bs",["cx","fbt","bs_array","bs_block","bs_curry","React","Utils.bs","MercuryIDs","ReasonReact.bs","bs_js_primitive","MercuryMessages","MercuryAttachment","MercuryDispatcher","SphericalPhotoUtils","MercuryPayloadSource","SpotlightViewerReact.bs","MessengerSharedPhotoReact.bs","MessengerInfoPanelSectionReact.bs","MessengerSharedPhotosVideosData.bs","MessengerSharedPhotosAlbumViewContainerReact.bs","SpotlightMessengerSharedMediaViewerContainerReact.bs"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("React").createElement("div",{className:"_4dfu"}),k=c("ReasonReact.bs").reducerComponent("MessengerSharedPhotosReact");function l(n,o,p,q,r,s,t,u){__p&&__p();var v=function v(w){__p&&__p();var x=c("MessengerSharedPhotosVideosData.bs").get(s);if(t){var y=t[0];if(x)if(x[0][0][1]!==0&&!(q||!c("bs_curry")._1(o,0)||c("bs_curry")._1(p,0)===0))return c("MessengerSharedPhotosVideosData.bs").fetchOlder(12,y,s,function(){return c("bs_curry")._1(w[3],0)});else return 0;else return c("MessengerSharedPhotosVideosData.bs").fetchOlder(12,y,s,function(){return c("bs_curry")._1(w[3],0)})}else return 0};return[k[0],k[1],k[2],k[3],function(w){v(w);return 0},function(w){return v(w[0])},k[6],k[7],k[8],function(w){__p&&__p();var x=c("MessengerSharedPhotosVideosData.bs").get(s);if(t)if(x){var y=x[0][1];if(y)if(y[0][0].length!==0){var z=x[0],A=z[1][0],B=t[0],C=w[1][1],D=C?c("ReasonReact.bs").element(0,0,c("SpotlightMessengerSharedMediaViewerContainerReact.bs").make(function(){return c("bs_curry")._1(w[3],1)},function(H){return c("bs_curry")._1(w[3],c("bs_block").__(0,[H]))},C[0],"",B,0,[])):null,E=w[1][0],F=E?c("ReasonReact.bs").element(0,["spotlightViewer"],c("SpotlightViewerReact.bs").make("_3ode",function(){return c("bs_curry")._1(w[3],2)},1,[c("ReasonReact.bs").element(0,0,c("MessengerSharedPhotosAlbumViewContainerReact.bs").make(function(H){return c("bs_curry")._1(w[3],c("bs_block").__(1,[H]))},function(){return c("bs_curry")._1(w[3],2)},B,E[0],[]))])):null,G=i._("Shared Photos");return c("ReasonReact.bs").element(0,0,c("MessengerInfoPanelSectionReact.bs").make(0,[1],[q],[r],[G],[D,F,c("React").createElement("div",{className:"_40jj _5l-3"},c("bs_array").map(function(H){__p&&__p();var x=H.node.image,y=x==null?["_3m31 _ooh",0]:["_3m31",[x.uri]],I=y[1],J=H.node,z=J.photo_encodings,C;if(z==null)C=[0,I];else if(z.length!==0){var K=c("SphericalPhotoUtils").getThumbnailsFromPhotoEncodings(z).smallThumbnail,L=K==null?I:[K];C=[1,L]}else C=[0,I];return c("ReasonReact.bs").element([J.legacy_attachment_id],0,c("MessengerSharedPhotoReact.bs").make(y[0],J.legacy_attachment_id,function(M){return c("bs_curry")._1(w[3],c("bs_block").__(2,[M]))},J.id,C[1],C[0],[]))},A[0])),z[0][1]!==0&&A[3]===0?j:null]))}else return null;else return null}else return null;else return null},function(){return[0,0]},k[11],function(w,x){if(typeof w==="number")switch(w){case 0:return c("bs_block").__(0,[x]);case 1:return c("bs_block").__(0,[[x[0],0]]);case 2:return c("bs_block").__(0,[[0,x[1]]])}else switch(w.tag|0){case 0:return c("bs_block").__(0,[[[w[0]],0]]);case 1:return c("bs_block").__(0,[[0,[w[0]]]]);case 2:return c("bs_block").__(0,[[x[0],[w[0]]]])}},function(w){__p&&__p();var x=c("MercuryDispatcher").getForFBID(n);return[[function(){__p&&__p();return x.subscribe("update-messages",function(u,y){__p&&__p();if(y==null)return 0;else if(y.payload_source===c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE){var z=y.actions;if(z.length!==1)return 0;else{var A=z[0],B=A.thread_id,C=c("MercuryIDs").getThreadFBIDFromThreadID(B),D=A.attachments;if(D==null)return 0;else{var E=+D.some(function(K){if(c("MercuryAttachment").isPhotoAttachment(K))return 1;else return+c("MercuryAttachment").isVideoAttachment(K)});if(E)return c("MessengerSharedPhotosVideosData.bs").fetchNewer(Math.max(D.length,10),C,B,function(){return c("bs_curry")._1(w[3],0)});else return 0}}}else if(y.payload_source===c("MercuryPayloadSource").CLIENT_UPDATE_SNIPPET){var F=y.actions;if(F.length!==1)return 0;else{var G=F[0],H=G.thread_id,I=c("MercuryMessages").getForFBID(n),J=+I.getMessagesFromIDs(G.deleted_ids).some(function(y){__p&&__p();if(y==null)return 0;else{var z=y.attachments,K=z==null?[]:c("Utils.bs").arrayCompact(z.map(function(L){if(c("MercuryAttachment").isPhotoAttachment(L)||c("MercuryAttachment").isVideoAttachment(L)){var z=L.metadata;if(z==null)return 0;else return c("bs_js_primitive").null_undefined_to_opt(z.fbid)}else return 0}));if(K.length!==0){c("MessengerSharedPhotosVideosData.bs").localRemove(H,K);return 1}else return 0}});if(J)return c("bs_curry")._1(w[3],0);else return 0}}else return 0})},function(y){y.unsubscribe();return 0}],0]},k[14]]}var m=c("ReasonReact.bs").wrapReasonForJs(k,function(n){return l(n.viewer,n.getIsScrolledToBottom,n.getScrollableHeight,+n.isCollapsed,n.onToggle,n.threadID,c("bs_js_primitive").null_undefined_to_opt(n.threadFBID),[])});g.endOfMediaIndicator=j;g.component=k;g.make=l;g.jsComponent=m}),null);