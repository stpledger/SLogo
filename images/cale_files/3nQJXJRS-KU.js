if (self.CavalryLogger) { CavalryLogger.start_js(["iaytM"]); }

__d("ChatSearchSource",["requireWeak","AbstractSearchSource","AsyncRequest","Bootloader","CurrentUser","MercuryParticipantTypes","MessengerSearchFunnelLoggerConstants","SearchableEntry","SearchSourceCallbackManager","ShortProfiles","TokenizeUtil","debounce","emptyFunction","isValidUniqueID"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=null;c("requireWeak")("OrderedFriendsList",function(l){j=l});h=babelHelpers.inherits(k,c("AbstractSearchSource"));i=h&&h.prototype;function k(l){i.constructor.call(this);this.$ChatSearchSource1=new(c("SearchSourceCallbackManager"))({parseFn:c("TokenizeUtil").parse,matchFn:c("TokenizeUtil").isQueryMatch,indexFn:l.indexFn});this.$ChatSearchSource2=l.queryRequests||[];this.$ChatSearchSource3=l.searchType||"";this.$ChatSearchSource4=false;this.$ChatSearchSource5=c("debounce")(this.$ChatSearchSource5,100,this);this.$ChatSearchSource6=l.excludeMemorializedUsers||false;this.$ChatSearchSource7=""}k.prototype.bootstrapImpl=function(l){c("ShortProfiles").fetchAll().done(function(){this.$ChatSearchSource4=true;this.$ChatSearchSource8();l()}.bind(this))};k.prototype.searchImpl=function(l,m,n){__p&&__p();var o=null,p={},q=n&&n.onQueryFinished,r=n&&n.onQueryStarted;r&&r(l);var s=this.$ChatSearchSource1.search(l,function(v){__p&&__p();if(!o){o=v;o.forEach(function(w){return p[w.getUniqueID()]=true})}else v.forEach(function(w){var x=w.getUniqueID();if(!p[x]){o.push(w);p[x]=true}});m(o,l);if(l.length===1&&this.$ChatSearchSource4)q&&q(l)}.bind(this),n);if(!s||!this.$ChatSearchSource2||!this.$ChatSearchSource2.length||l.length===0){q&&q(l);return}if(l.length===1){if(this.$ChatSearchSource4)q&&q(l);return}var t={value:l,existing_ids:o&&o.map(function(v){return v.getUniqueID()}).join(","),limit:n&&n.threadLimit,exclude_memorialized_users:this.$ChatSearchSource6},u=this.$ChatSearchSource2.length;this.$ChatSearchSource2.forEach(function(v){__p&&__p();this.$ChatSearchSource5(t,v,function(w){__p&&__p();var x=this.$ChatSearchSource9(this.$ChatSearchSource10(w)).filter(function(y){return!!y});if(this.$ChatSearchSource3===c("MessengerSearchFunnelLoggerConstants").WWW_SIDEBAR_TAG)c("Bootloader").loadModules(["MessengerUniversalSearchFunnelLogger","MessengerUniversalSearchFunnelLoggerConstants"],function(y,z){y.logSourceEnded(l,z.TAGS.SERVER,x.length,z.TAGS.FINISHED)},"ChatSearchSource");this.$ChatSearchSource11(x,l);u--;if(u===0){this.$ChatSearchSource1.setQueryStringAsExhausted(l);q&&q(l)}}.bind(this))}.bind(this),this)};k.prototype.getAllEntriesMap=function(){return this.$ChatSearchSource1.getAllEntries()};k.prototype.$ChatSearchSource8=function(){var l=c("ShortProfiles").getCachedProfileIDs(),m=l.filter(function(o){var p=c("ShortProfiles").getNow(o);return o==c("CurrentUser").getID()||p.type===c("MercuryParticipantTypes").FRIEND||p.type===c("MercuryParticipantTypes").FB4C}),n=m.map(this.$ChatSearchSource12);if(n.length)this.$ChatSearchSource1.addLocalEntries(n)};k.prototype.$ChatSearchSource9=function(l){return l.map(this.$ChatSearchSource13,this)};k.prototype.$ChatSearchSource13=function(l,m){__p&&__p();if(l.mercury_thread){if(!j)return null;return j.normalizeThreadEntry(l,m)}var n=l.text,o=l.uid;if(!n||!c("isValidUniqueID")(o))return null;var p=j?j.getActiveRank(o):0;if(j&&!j.contains(o))p+=m;return new(c("SearchableEntry"))({uniqueID:o,title:n,order:p,subtitle:l.subtext,type:l.render_type||l.type,photo:l.photo,uri:l.path,auxiliaryData:{isMessengerUser:l.is_messenger_user,alias:l.alias}})};k.prototype.$ChatSearchSource10=function(l){var m=l.getPayload();if(Array.isArray(m))return m;else if(m&&m.entries)return m.entries;else return[]};k.prototype.$ChatSearchSource12=function(l){var m=c("ShortProfiles").getNow(l),n=l==c("CurrentUser").getID()?c("MercuryParticipantTypes").FRIEND:m.type,o=[m.additionalName,m.alternateName].concat(m.searchTokens||[]).join(" "),p=m.name,q=null;return new(c("SearchableEntry"))({uniqueID:l,title:p,order:j?j.getActiveRank(l):0,subtitle:q,keywordString:o,type:n,photo:m.thumbSrc,uri:m.uri,auxiliaryData:{isMessengerUser:m.is_messenger_user,alias:m.alias}})};k.prototype.$ChatSearchSource5=function(l,m,n,o){if(this.$ChatSearchSource3===c("MessengerSearchFunnelLoggerConstants").WWW_SIDEBAR_TAG&&l.value!==this.$ChatSearchSource7){c("Bootloader").loadModules(["MessengerSearchFunnelLogger","MessengerUniversalSearchFunnelLogger","MessengerUniversalSearchFunnelLoggerConstants"],function(p,q,r){p.logStartQuery(c("MessengerSearchFunnelLoggerConstants").NAME,l.value);q.logSourceStarted(l.value,r.TAGS.SERVER)},"ChatSearchSource");this.$ChatSearchSource7=l.value}new(c("AsyncRequest"))(m.uri).setData(babelHelpers["extends"]({},l,m.data)).setMethod("GET").setReadOnly(true).setHandler(n).setErrorHandler(o||c("emptyFunction")).setAllowCrossPageTransition(true).send()};k.prototype.$ChatSearchSource11=function(l,m){if(l.length)this.$ChatSearchSource1.addQueryEntries(l,m)};k.prototype.addLocalEntries=function(l){this.$ChatSearchSource1.addLocalEntries(l)};k.prototype.refreshData=function(){c("ShortProfiles").fetchAll()};f.exports=k}),null);
__d("ChatTypeaheadConstants",[],(function a(b,c,d,e,f,g){var h=Object.freeze({USER_TYPE:"user",THREAD_TYPE:"thread",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",PAGE_TYPE:"page",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",HEADER_TYPE:"header",INTERNAL_BOT_PAGE_TYPE:"internal_bot_page",GAME_TYPE:"game"});f.exports=h}),null);
__d("MessengerGroupCreateDialog.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{entryPoint:this.props.entryPoint,isShown:this.props.isShown,onClose:this.props.onClose}),loader:c("JSResource")("MessengerGroupCreateDialogImpl.react").__setRef("MessengerGroupCreateDialog.react"),placeholder:c("React").createElement("div",null)})};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("MessengerGroupCreateDialogReact.bs",["bs_js_boolean","ReasonReact.bs","MessengerGroupCreateDialog.react"],(function a(b,c,d,e,f,g){"use strict";function h(i,j,k,l){return c("ReasonReact.bs").wrapJsForReason(c("MessengerGroupCreateDialog.react"),{entryPoint:i,isShown:c("bs_js_boolean").to_js_boolean(j),onClose:k},l)}g.make=h}),null);
__d("MessengerGroupCreationEntryPoint",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CHAT_TAB:"chat_tab_add_people",JEWEL:"jewel_new_message",CHAT_SIDEBAR:"chat_sidebar_new_message",GCF_JEWEL:"jewel_new_group",GCF_CHAT_SIDEBAR:"chat_sidebar_new_group",GCF_SHARE_FLOW:"chat_share_message_to_messenger"})}),null);
__d("ChatSidebarGroupCreateButtonReact.bs",["cx","fbt","bs_block","bs_curry","React","LinkReact.bs","ReasonReact.bs","joinClasses","bs_js_primitive","MessengerGroupCreateDialogReact.bs","MessengerGroupCreationEntryPoint"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("ReasonReact.bs").reducerComponent("ChatSidebarGroupCreateButtonReact"),k=c("MessengerGroupCreationEntryPoint").GCF_CHAT_SIDEBAR;function l(o){var p=o[1];if(p!==0)return c("ReasonReact.bs").element(0,0,c("MessengerGroupCreateDialogReact.bs").make(k,1,function(){return c("bs_curry")._1(o[3],1)},[]));else return null}function m(o,p){__p&&__p();var q=j.slice();q[9]=function(r){var s=i._("Create New Group"),t="_1-4-",u=o?c("joinClasses")(t,o[0]):t;return c("React").createElement("div",{className:"_46fv"},l(r),c("ReasonReact.bs").element(0,0,c("LinkReact.bs").make([s],[u],["tooltip"],[s],0,["below"],0,0,[function(){return c("bs_curry")._1(r[3],0)}],0,0,0,0,0,0,0,[])))};q[10]=function(){return 0};q[12]=function(r,p){if(r!==0)return c("bs_block").__(0,[0]);else return c("bs_block").__(0,[1])};return q}var n=c("ReasonReact.bs").wrapReasonForJs(j,function(o){return m(c("bs_js_primitive").null_undefined_to_opt(o.className),[])});g.component=j;g.entryPoint=k;g.renderDialog=l;g.make=m;g.jsComponent=n}),null);
__d("ChatNotificationConstants",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({NORMAL:0,NO_USER_MESSAGE_NOTIFICATION:1})}),null);
__d("ChatBehavior",["Arbiter","AvailableList","AvailableListConstants","ChatNotificationConstants"],(function a(b,c,d,e,f,g){__p&&__p();var h=false,i=c("AvailableList").getWebChatNotification&&c("AvailableList").getWebChatNotification(),j=h,k=true,l=Object.assign(new(c("Arbiter"))(),{ON_CHANGED:"changed",notifiesUserMessages:function n(){return i!==c("ChatNotificationConstants").NO_USER_MESSAGE_NOTIFICATION},ignoresRemoteTabRaise:function n(){return j},showsTabUnreadUI:function n(){return k}});function m(){l.inform(l.ON_CHANGED)}c("AvailableList").subscribe&&c("AvailableList").subscribe(c("AvailableListConstants").ON_CHAT_NOTIFICATION_CHANGED,function(){var n=i,o=c("AvailableList").getWebChatNotification();i=o;if(n!=o)m()});c("Arbiter").subscribe("chat/set_does_page_occlude_tabs",function(n,o){j=!!o;m()});c("Arbiter").subscribe("chat/set_show_tab_unread_ui",function(n,o){k=!!o;m()});f.exports=l}),null);
__d("ChatSidebarSheetChatOffline.react",["fbt","Link.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").PureComponent);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("div",null,h._("{=Go online} to see who's available.",[h.param("=Go online",c("React").createElement(c("Link.react"),{className:"fbChatGoOnlineLink",onClick:this.props.onGoOnlineClick},h._("Turn on chat")))]))};function l(){i.apply(this,arguments)}l.propTypes={onGoOnlineClick:k.func.isRequired};f.exports=l}),null);
__d("ChatSidebarSheetChatReconnectMsg.react",["fbt","ChannelConstants","Link.react","MessengerSpinner.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").PureComponent);j=i&&i.prototype;l.prototype.render=function(){var m=this.props,n=m.isMessenger,o=m.msecs,p=c("React").createElement(c("Link.react"),{className:"fbChatReconnectLink",onClick:this.props.onManuallyConnectClick},h._("No Internet Connection"));if(o==null||false===navigator.onLine)return n?p:c("React").createElement("div",null,h._("Unable to connect to chat. Check your Internet connection."));else if(o>c("ChannelConstants").WARNING_COUNTDOWN_THRESHOLD_MSEC)return n?p:c("React").createElement("div",null,h._("Unable to connect to chat. {try-again-link}",[h.param("try-again-link",c("React").createElement(c("Link.react"),{className:"fbChatReconnectLink",onClick:this.props.onManuallyConnectClick},h._("Try again")))]));else if(o>1e3)return n?p:c("React").createElement("div",null,h._("Unable to connect to chat. Reconnecting in {seconds}",[h.param("seconds",Math.floor(o/1e3))]));else return n?c("React").createElement("div",null,c("React").createElement(c("MessengerSpinner.react"),{color:"grey"}),h._("Connecting...")):c("React").createElement("div",null,h._("Unable to connect to chat. Reconnecting..."))};function l(){i.apply(this,arguments)}l.propTypes={isMessenger:k.bool,msecs:k.number,onManuallyConnectClick:k.func};f.exports=l}),null);
__d("ChatSidebarSheetChatShutdownMsg.react",["fbt","ChannelConstants","CurrentUser","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").PureComponent);j=i&&i.prototype;l.prototype.render=function(){var m=this.props,n=m.hint,o=m.isMessenger;switch(n){case c("ChannelConstants").HINT_AUTH:return c("React").createElement("div",null,h._("Your session has timed out. Please log in."));case c("ChannelConstants").HINT_MAINT:return o?c("React").createElement("div",null,h._("Messenger is currently down for maintenance.")):c("React").createElement("div",null,h._("{Chat} is currently down for maintenance.",[h.param("Chat",h._("Chat"))]));case c("ChannelConstants").HINT_CONN:default:if(!o)return c("React").createElement("div",null,h._("{Chat} is currently unavailable.",[h.param("Chat",h._("Chat"))]));else if(c("CurrentUser").isWorkUser())return c("React").createElement("div",null,h._("Workplace Chat is currently unavailable."));else return c("React").createElement("div",null,h._("Messenger is currently unavailable."))}};function l(){i.apply(this,arguments)}l.propTypes={hint:k.string,isMessenger:k.bool};f.exports=l}),null);
__d("ChatSidebarSheet.react",["fbt","Arbiter","ChannelConnection","ChatBehavior","ChatSidebarSheetChatOffline.react","ChatSidebarSheetChatReconnectMsg.react","ChatSidebarSheetChatShutdownMsg.react","ChatVisibility","MercuryConfig","MessengerEnvironment","CSS","JSLogger","LogHistory","MercurySyncConstants","PresencePrivacy","React","SubscriptionsHandler","emptyFunction","joinClasses","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("JSLogger").create("sidebar_sheet"),l=c("LogHistory").getInstance("sidebar_sheet"),m=c("React").PropTypes;i=babelHelpers.inherits(n,c("React").PureComponent);j=i&&i.prototype;function n(o){j.constructor.call(this,o);this.$ChatSidebarSheet3=function(p,q){this.setState({channelStatus:p,channelData:q});this.$ChatSidebarSheet4()}.bind(this);this.$ChatSidebarSheet4=function(){this.setState({isConnected:!c("ChannelConnection").disconnected(),isOnline:c("ChatVisibility").isOnline(),notifiesUserMessages:c("ChatBehavior").notifiesUserMessages()})}.bind(this);this.state={channelStatus:null,channelData:null,isConnected:!c("ChannelConnection").disconnected(),isOnline:c("ChatVisibility").isOnline(),notifiesUserMessages:c("ChatBehavior").notifiesUserMessages(),syncStateInvalid:false,syncStateReconnecting:false}}n.prototype.componentDidMount=function(){this.$ChatSidebarSheet1=new(c("SubscriptionsHandler"))();this.$ChatSidebarSheet1.addSubscriptions(c("ChannelConnection").subscribe([c("ChannelConnection").CONNECTED,c("ChannelConnection").SHUTDOWN,c("ChannelConnection").RECONNECTING],this.$ChatSidebarSheet3),c("ChannelConnection").subscribe([c("ChannelConnection").MUTE_WARNING,c("ChannelConnection").UNMUTE_WARNING],this.$ChatSidebarSheet4),c("PresencePrivacy").subscribe("privacy-user-presence-changed",this.$ChatSidebarSheet4),c("ChatBehavior").subscribe(c("ChatBehavior").ON_CHANGED,this.$ChatSidebarSheet4),c("Arbiter").subscribe(c("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE,function(){l.log("invalid state fatal","{}");this.setState({syncStateInvalid:true,syncStateReconnecting:false})}.bind(this)),c("Arbiter").subscribe(c("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RETRY,function(){l.log("retry from invalid state","{}");this.$ChatSidebarSheet5()}.bind(this)),c("Arbiter").subscribe(c("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RECOVER,function(){l.log("recover from invalid state","{}");this.$ChatSidebarSheet6()}.bind(this)))};n.prototype.componentWillUpdate=function(){if(this.$ChatSidebarSheet2){clearTimeout(this.$ChatSidebarSheet2);this.$ChatSidebarSheet2=null}};n.prototype.componentWillUnmount=function(){this.$ChatSidebarSheet1&&this.$ChatSidebarSheet1.release()};n.prototype.render=function(){__p&&__p();var o=c("MessengerEnvironment").messengerui,p=void 0,q=void 0;if(!this.state.isOnline&&!o){p="offline";q=this.$ChatSidebarSheet7()}else if(!this.state.isConnected||this.state.syncStateInvalid||this.state.syncStateReconnecting){p="error";q=this.$ChatSidebarSheet8(o)}else if(!this.state.notifiesUserMessages&&!o){p="notice";q=this.$ChatSidebarSheet9()}if(this.state.channelStatus===c("ChannelConnection").RECONNECTING&&this.state.channelData<1e3||this.state.syncStateReconnecting)p=c("joinClasses")(p,"reconnecting");return c("React").createElement("div",{className:c("joinClasses")(this.props.className,p)},o?null:c("React").createElement("div",{className:"img"}),c("React").createElement("div",{className:"message"},q))};n.prototype.$ChatSidebarSheet8=function(o){__p&&__p();if(this.state.channelStatus===c("ChannelConnection").SHUTDOWN||this.state.syncStateInvalid)return c("React").createElement(c("ChatSidebarSheetChatShutdownMsg.react"),{hint:this.state.syncStateInvalid?undefined:this.state.channelData,isMessenger:o});else if(this.state.channelStatus===c("ChannelConnection").RECONNECTING||this.state.syncStateReconnecting){var p=this.state.syncStateReconnecting?1:this.state.channelData;if(p>1e3)this.$ChatSidebarSheet2=c("setTimeoutAcrossTransitions")(this.$ChatSidebarSheet3.bind(this,c("ChannelConnection").RECONNECTING,p-1e3),1e3);return c("React").createElement(c("ChatSidebarSheetChatReconnectMsg.react"),{isMessenger:o,msecs:p,onManuallyConnectClick:function(){if(!this.state.syncStateReconnecting)c("ChannelConnection").reconnect()}.bind(this)})}return null};n.prototype.$ChatSidebarSheet7=function(){return c("React").createElement(c("ChatSidebarSheetChatOffline.react"),{onGoOnlineClick:function o(p){k.log("sidebar_go_online");c("ChatVisibility").goOnline()}})};n.prototype.$ChatSidebarSheet9=function(){return c("React").createElement("div",null,h._("Alerts are off while you use another client to chat."))};n.prototype.$ChatSidebarSheet5=function(){this.setState({syncStateReconnecting:true})};n.prototype.$ChatSidebarSheet6=function(){this.setState({syncStateInvalid:false,syncStateReconnecting:false})};f.exports=n}),null);
__d("MessengerSearchSource",["ChatSearchSource","MercuryConfig","MercuryIDs","MercuryParticipants","MercuryParticipantTypes","MercurySingletonProvider","MessengerEnvironment","MessengerSearchFunnelLoggerConstants","MessengerTypeaheadUtils","SearchableEntry","emptyFunction","requireWeak"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=50,k=c("MessengerEnvironment").messengerui;h=babelHelpers.inherits(l,c("ChatSearchSource"));i=h&&h.prototype;l.getForFBID=function(n){return m.getForFBID(n)};l.get=function(){return m.get()};function l(n){i.constructor.call(this,{queryRequests:[{uri:"/ajax/mercury/composer_query.php"}],searchType:c("MessengerSearchFunnelLoggerConstants").WWW_SIDEBAR_TAG});this.$MessengerSearchSource1=[];this.$MessengerSearchSource2=n}l.prototype.bootstrapImpl=function(n){c("requireWeak")("OrderedFriendsList",function(p){return p.getSearchableEntries(j,true,function(q){this.$MessengerSearchSource1=q;i.addLocalEntries.call(this,q)}.bind(this))}.bind(this));var o=c("MercuryIDs").getParticipantIDFromUserID(this.$MessengerSearchSource2);c("MercuryParticipants").get(o,function(p){i.addLocalEntries.call(this,[new(c("SearchableEntry"))({uniqueID:p.fbid?p.fbid.toString():p.id,title:p.name,type:c("MercuryParticipantTypes").FRIEND,photo:p.big_image_src||p.image_src,uri:p.href,auxiliaryData:{isMessengerUser:p.is_messenger_user}})])}.bind(this));i.bootstrapImpl.call(this,c("emptyFunction"));n()};l.prototype.searchImpl=function(n,o,p){p=p||{};if(n===""&&p.showDefaultEntries){o(this.$MessengerSearchSource1,n);var q=p&&p.onQueryFinished;q&&q(n);return}p.threadLimit=c("MercuryConfig").MaxThreadResults;i.searchImpl.call(this,n,this.$MessengerSearchSource3(o,p),p)};l.prototype.$MessengerSearchSource3=function(n,o){return k&&o&&o.showThreadSearchEntry?function(p,q){var r=c("MessengerTypeaheadUtils").getMessageSearchEntry(q);if(r)n([r].concat(p),q);else n(p,q)}:n};var m=new(c("MercurySingletonProvider"))(l);f.exports=l}),null);
__d("MessengerSearchTypeahead.react",["cx","fbt","ix","AbstractTypeahead.react","Bootloader","CurrentUser","Image.react","MercuryIDs","MercuryThreadIDMap","MercuryThreads","MercuryTypeaheadConstants","MercuryVanityIDMap.bs","MessengerSearchFunnelLoggerConstants","MessengerSearchSource","MessengerUniversalSearchFunnelLoggerConstants","React","TypeaheadNavigation","ifRequired","joinClasses"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l,m=c("MercuryThreadIDMap").get(),n=c("MercuryThreads").get(),o=c("React").PropTypes,p=j("86933"),q=100,r=null,s=null,t=c("MessengerUniversalSearchFunnelLoggerConstants").TAGS,u=t.ABANDON,v=t.END_ACTION,w=t.SIDEBAR,x=t.WWW;k=babelHelpers.inherits(y,c("React").PureComponent);l=k&&k.prototype;function y(){var A,B;for(var C=arguments.length,D=Array(C),E=0;E<C;E++)D[E]=arguments[E];return B=(A=l.constructor).call.apply(A,[this].concat(D)),z.call(this),B}y.prototype.componentWillMount=function(){__p&&__p();var A=function A(C,D,E){var F=C.indexOf(D),G=F==-1?C.length-1:F-1;E(G==-1?C[C.length-1]:C[G])},B=function B(C,D,E){var F=C.indexOf(D)+1;E(F==C.length?C[0]:C[F])};A=c("TypeaheadNavigation").moveDown;B=c("TypeaheadNavigation").moveUp;this.$MessengerSearchTypeahead1=function(C){for(var D=arguments.length,E=Array(D>1?D-1:0),F=1;F<D;F++)E[F-1]=arguments[F];return A.apply(undefined,[s.orderEntries(C,this.props.queryString)].concat(E))}.bind(this);this.$MessengerSearchTypeahead2=function(C){for(var D=arguments.length,E=Array(D>1?D-1:0),F=1;F<D;F++)E[F-1]=arguments[F];return B.apply(undefined,[s.orderEntries(C,this.props.queryString)].concat(E))}.bind(this)};y.prototype.render=function(){var A=this.props.isFacebookChat?i._("Search"):i._("Search Messenger"),B=c("CurrentUser").isWorkUser()?i._("coworkers to message"):i._("friends to message");return c("React").createElement("div",{className:"_3rh8"},c("React").createElement(c("AbstractTypeahead.react"),{"aria-label":B,autoHighlight:this.props.isFacebookChat,blurOnWindowBlur:false,className:c("joinClasses")(this.props.className||"","_5iwm"+(this.props.isFocused||!!this.props.queryString?" _5iwn":"")+" _150g"+(this.props.hideResults?" _1a03":"")),disabled:this.props.hideResults,inputClassName:"_3rhb navigationFocus",navigation:{moveUp:this.$MessengerSearchTypeahead1,moveDown:this.$MessengerSearchTypeahead2},onBlur:this.$MessengerSearchTypeahead3,onChange:this.$MessengerSearchTypeahead4,onFocus:this.$MessengerSearchTypeahead5,onMouseOver:this.$MessengerSearchTypeahead6,onClick:this.$MessengerSearchTypeahead6,onSelectAttempt:this.$MessengerSearchTypeahead7,placeholder:A.toString(),presenter:{ViewRenderer:r,alwaysVisibleOnFocus:true,extraRendererProps:{className:"_11_d",hasHoverState:this.props.isFacebookChat,isLoading:this.state.isLoading,onScrollIntoView:this.props.onScrollIntoView,viewer:this.props.viewer},maxEntries:this.props.maxEntries||q,sortEntries:this.$MessengerSearchTypeahead8,useLayer:false},queryString:this.props.queryString,role:"search",searchSource:c("MessengerSearchSource").getForFBID(this.props.viewer),searchSourceOptions:{onQueryFinished:this.$MessengerSearchTypeahead9,onQueryStarted:this.$MessengerSearchTypeahead10,showDefaultEntries:!this.props.isFacebookChat,showThreadSearchEntry:!this.props.isFacebookChat&&!!this.props.queryString},selectOnTab:true,spellCheck:false,showEntriesOnFocus:true}),c("React").createElement(c("Image.react"),{onMouseDown:function(){var C;this.$MessengerSearchTypeahead11();(C=this.props).onClear.apply(C,arguments)}.bind(this),className:c("joinClasses")(this.props.className||"",(!this.props.queryString?"hidden_elem":"")+" _2xme"),src:p}))};y.prototype.$MessengerSearchTypeahead11=function(){c("Bootloader").loadModules(["MessengerSearchFunnelLogger"],function(A){A.logClearQuery(c("MessengerSearchFunnelLoggerConstants").NAME)},"MessengerSearchTypeahead.react")};y.propTypes={className:o.string,hideResults:o.bool,isFacebookChat:o.bool,isFocused:o.bool,maxEntries:o.number,onBlur:o.func,onChange:o.func,onClear:o.func,onFocus:o.func,onSelect:o.func.isRequired,onScrollIntoView:o.func,queryString:o.string,viewer:o.string.isRequired};var z=function z(){__p&&__p();this.state={isLoading:false,orderable:!!s};this.$MessengerSearchTypeahead3=function(){var A;(A=this.props).onBlur.apply(A,arguments);c("Bootloader").loadModules(["MessengerSearchFunnelLogger","MessengerUniversalSearchFunnelLogger"],function(B,C){B.endFunnel(c("MessengerSearchFunnelLoggerConstants").NAME);C.endFunnel(v,u)},"MessengerSearchTypeahead.react")}.bind(this);this.$MessengerSearchTypeahead4=function(){var A;(A=this.props).onChange.apply(A,arguments)}.bind(this);this.$MessengerSearchTypeahead5=function(){this.$MessengerSearchTypeahead6();c("Bootloader").loadModules(["MessengerSearchFunnelLogger","MessengerUniversalSearchFunnelLogger"],function(A,B){A.startFunnel(c("MessengerSearchFunnelLoggerConstants").NAME,c("MessengerSearchFunnelLoggerConstants").WWW_SIDEBAR_TAG,c("MessengerSearchFunnelLoggerConstants").UNIVERSAL_SEARCH);B.startFunnel(w,x)},"MessengerSearchTypeahead.react")}.bind(this);this.$MessengerSearchTypeahead6=function(){if(!this.state.orderable)c("Bootloader").loadModules(["MessengerTypeaheadView.react","MessengerTypeaheadUtils"],function(A,B){c("ifRequired")("FantaTabsEagerBootloader",function(C){return C.bootload()});r=A;s=B;this.setState({orderable:true})}.bind(this),"MessengerSearchTypeahead.react")}.bind(this);this.$MessengerSearchTypeahead10=function(A){if(A===this.props.queryString)this.setState({isLoading:true})}.bind(this);this.$MessengerSearchTypeahead9=function(A){if(A===this.props.queryString)this.setState({isLoading:false})}.bind(this);this.$MessengerSearchTypeahead8=function(A){return s?s.sortEntries(A,this.props.queryString):A}.bind(this);this.$MessengerSearchTypeahead7=function(A,B){__p&&__p();var C,D=this,E=A.getUniqueID(),F=A.getType(),G=A.getAuxiliaryData().alias;if(G)c("MercuryVanityIDMap.bs").set(G,c("MercuryIDs").getParticipantIDFromUserID(E));if(F===c("MercuryTypeaheadConstants").THREAD_TYPE)m.getClientIDFromServerID(E,function(H){this.props.onSelect(H,F);c("Bootloader").loadModules(["MessengerSearchFunnelLogger","MessengerUniversalSearchFunnelLogger"],function(I,J){I.logResultSelection(c("MessengerSearchFunnelLoggerConstants").NAME,this.props.queryString,H,c("MessengerSearchFunnelLoggerConstants").GROUP);J.logResultSelected(this.props.queryString,H,c("MessengerUniversalSearchFunnelLoggerConstants").RESULT_TYPES.GROUP,c("MessengerUniversalSearchFunnelLoggerConstants").TAGS.TYPEAHEAD)}.bind(this),"MessengerSearchTypeahead.react")}.bind(this));else(function(){__p&&__p();var H=void 0;switch(F){case c("MercuryTypeaheadConstants").FRIEND_TYPE:H=c("MessengerSearchFunnelLoggerConstants").USER_CONTACT;break;case c("MercuryTypeaheadConstants").NON_FRIEND_TYPE:H=c("MessengerSearchFunnelLoggerConstants").USER_NON_CONTACT;break;case c("MercuryTypeaheadConstants").FB4C_TYPE:H=c("MessengerSearchFunnelLoggerConstants").COWORKER;break;case c("MercuryTypeaheadConstants").GAME_TYPE:H=c("MessengerSearchFunnelLoggerConstants").GAME;break;case c("MercuryTypeaheadConstants").PAGE_TYPE:case c("MercuryTypeaheadConstants").INTERNAL_BOT_PAGE_TYPE:case c("MercuryTypeaheadConstants").COMMERCE_PAGE_TYPE:case c("MercuryTypeaheadConstants").MEETING_ROOM_PAGE_TYPE:H=c("MessengerSearchFunnelLoggerConstants").PAGE;break;default:H=c("MessengerSearchFunnelLoggerConstants").OTHER}n.getThreadMeta(c("MercuryIDs").getThreadIDFromUserID(E),function(I){this.props.onSelect(I.thread_id,F);c("Bootloader").loadModules(["MessengerSearchFunnelLogger","MessengerUniversalSearchFunnelLogger"],function(J,K){J.logResultSelection(c("MessengerSearchFunnelLoggerConstants").NAME,this.props.queryString,I.thread_id,H);K.logResultSelected(this.props.queryString,I.thread_id,H,c("MessengerUniversalSearchFunnelLoggerConstants").TAGS.TYPEAHEAD)}.bind(this),"MessengerSearchTypeahead.react")}.bind(D))})()}.bind(this)};f.exports=y}),null);
__d("ChatTypeaheadWrapper.react",["cx","Arbiter","Bootloader","ChatConfig","ChatOpenTabEventLogger","ChatSidebarActions","ChatSidebarComposeLink.react","ChatSidebarDropdown.react","ChatSidebarGroupCreateButtonReact.bs","ChatSidebarSections","ChatSidebarSheet.react","ChatTypeaheadConstants","FantaTabActions","MercuryIDs","MercuryParticipantTypes","MessengerSearchTypeahead.react","React","SidebarType","emptyFunction","getActiveElement","gkx","ifRequired"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=40,l=c("ChatConfig").get("divebar_rounded_profile",false);function m(o){c("Arbiter").inform("sidebar/typeahead/active",o)}i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.state={height:0,value:this.getInitialQueryString(),isSearching:!!this.getInitialQueryString()},this.$ChatTypeaheadWrapper1=function(){this.setState({isSearching:false,value:""})}.bind(this),p}n.prototype.getInitialQueryString=function(){var o="";if(c("gkx")("AT6Vd8Lbi8UqLKJqQjAcfopWe5cqEOccp4eiS-V8yRxIDMKBLX2DogknGNtScECqpDmo8hLH8oHxnmHNnFmaPT0QTS-6M2LFaLgAiPg3H1wdHg"))c("ifRequired")("ChatTypeaheadCore",function(p){o=p.getLastSearchQuery()});return o?o:""};n.prototype.componentDidMount=function(){if(c("gkx")("AT6Vd8Lbi8UqLKJqQjAcfopWe5cqEOccp4eiS-V8yRxIDMKBLX2DogknGNtScECqpDmo8hLH8oHxnmHNnFmaPT0QTS-6M2LFaLgAiPg3H1wdHg"))c("ifRequired")("ChatTypeaheadCore",function(o){o.processInteractionsQueue()});if(this.props.isSidebar)c("Arbiter").subscribe("sidebar/resized",function(o,p){this.setState({height:p})}.bind(this));else c("Arbiter").subscribe("buddyList/resized",function(o,p){this.setState({height:p})}.bind(this))};n.prototype.componentWillUpdate=function(o,p){if(p.isSearching!==this.state.isSearching)m(p.isSearching)};n.prototype.render=function(){__p&&__p();var o=this.state.height!=null?Math.floor((this.state.height-k*2)/k):null;return c("React").createElement("div",{id:"chatsearch",className:!l?"squareProfile":""},!c("gkx")("AT6Vd8Lbi8UqLKJqQjAcfopWe5cqEOccp4eiS-V8yRxIDMKBLX2DogknGNtScECqpDmo8hLH8oHxnmHNnFmaPT0QTS-6M2LFaLgAiPg3H1wdHg")?c("React").createElement(c("ChatSidebarSheet.react"),{className:"fbChatSidebarMessage"}):null,c("React").createElement(c("MessengerSearchTypeahead.react"),{className:"_62it",isFacebookChat:true,isFocused:true,maxEntries:o,queryString:this.state.value,viewer:this.props.id,onBlur:this.$ChatTypeaheadWrapper1,onChange:function(p){var q=p.target.value;c("Bootloader").loadModules(["MessengerUniversalSearchFunnelLogger"],function(r){r.logQueryChanged(q)},"ChatTypeaheadWrapper.react");this.setState({isSearching:q!=="",value:q})}.bind(this),onClear:c("emptyFunction"),onScrollIntoView:c("emptyFunction"),onSelect:function(p,q){__p&&__p();c("getActiveElement")().blur();if(q===c("ChatTypeaheadConstants").MEETING_ROOM_PAGE_TYPE)c("Bootloader").loadModules(["goURI"],function(s){this.setState({isSearching:false,value:""});var r=c("MercuryIDs").getUserIDFromThreadID(p);s("/"+(r||""))}.bind(this),"ChatTypeaheadWrapper.react");else{c("FantaTabActions").openTab(p,"chat_sidebar_typeahead");var r=null;if(!q||q===c("MercuryParticipantTypes").FRIEND||q===c("ChatTypeaheadConstants").FRIEND_TYPE||q===c("ChatTypeaheadConstants").PAGE_TYPE||q===c("ChatTypeaheadConstants").USER_TYPE)if(c("MercuryIDs").isValidThreadID(p))r=c("MercuryIDs").getUserIDFromThreadID(p);c("ChatOpenTabEventLogger").logClickOpen(c("ChatSidebarSections").TYPEAHEAD,p,r)}}.bind(this)}),this.props.isSidebar?c("React").createElement("div",{className:"_531b"},c("React").createElement(c("ChatSidebarDropdown.react"),{sidebarType:c("SidebarType").SIDEBAR,onToggleSidebar:c("ChatSidebarActions").disable}),c("React").createElement(c("ChatSidebarComposeLink.react"),{className:"_3a-4 _5q85"}),c("React").createElement(c("ChatSidebarGroupCreateButtonReact.bs").jsComponent,null)):null)};f.exports=n}),null);